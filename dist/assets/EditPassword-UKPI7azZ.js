import{u as b,r as n,j as e,X as d,t as C}from"./index-CBGP0-9V.js";import{b as E}from"./user-BeTEafWb.js";import{b as N}from"./public-DIX_InEl.js";import{u as f}from"./request-CRuLXg2Q.js";import{C as j}from"./chevron-left-BTOK750O.js";import{C as S}from"./check-4WT4jp_I.js";function F(){const u=b(),[a,x]=n.useState(""),[s,m]=n.useState(""),[o,p]=n.useState(""),[h,i]=n.useState(!1),[c,r]=n.useState(""),w=t=>t?/^(?![0-9]+$)(?![a-zA-Z]+$)(?![^0-9a-zA-Z]+$).{6,}$/.test(t)?"":"密码必须包含数字、字母和特殊符号中至少两种组合，且长度不少于6位":"",g=(t,l)=>l&&t!==l?"两次输入的新密码不一致":"";n.useEffect(()=>{if(!a&&!s&&!o){r("");return}const t=w(s);if(t){r(t);return}const l=g(s,o);if(l){r(l);return}r("")},[a,s,o]);const v=async()=>{if(!a||!s||!o){r("请填写完整信息");return}if(!c)try{i(!0);const t=await E({password:a,newPassword:s});t?(C({description:e.jsxs("div",{className:"flex flex-col items-center justify-center min-w-[200px] min-h-[100px]",children:[e.jsx(S,{className:"w-10 h-10 mb-1"}),e.jsx("span",{className:"text-lg font-medium",children:"密码修改成功，请重新登录"})]}),variant:"default",duration:1e3}),await N(),localStorage.removeItem("ACCESS_USER_ID"),localStorage.removeItem("USER_INFO"),localStorage.removeItem("ACCESS_TOKEN"),localStorage.removeItem("REFRESH_TOKEN"),f.getState().auth.resetAccessToken(),f.getState().auth.reset(),setTimeout(()=>{u("/login")},2e3)):(r(t.message||"密码修改失败"),i(!1))}catch(t){r(t.message||"密码修改失败，请稍后重试"),i(!1)}};return e.jsxs("div",{className:"min-h-[100dvh] bg-[#F8F8F8]",children:[e.jsxs("div",{className:"flex items-center px-3 py-4",children:[e.jsx(j,{className:"w-6 h-6",onClick:()=>u(-1)}),e.jsx("span",{className:"flex-1 text-center text-[18px] font-[600] mr-6",children:"修改密码"})]}),e.jsxs("div",{className:"px-5 mt-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"password",value:a,onChange:t=>x(t.target.value),placeholder:"请输入原密码",className:"w-full h-12 bg-white text-[14px] placeholder:text-[#999999] placeholder:text-[13px] border-b border-[#ECECEC] focus:border-[#0363E0] focus:outline-none transition-colors"}),a&&e.jsx(d,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#999999] cursor-pointer",onClick:()=>x("")})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"password",value:s,onChange:t=>m(t.target.value),placeholder:"请输入新密码",className:"w-full h-12 bg-white text-[14px] placeholder:text-[#999999] placeholder:text-[13px] border-b border-[#ECECEC] focus:border-[#0363E0] focus:outline-none transition-colors"}),s&&e.jsx(d,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#999999] cursor-pointer",onClick:()=>m("")})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"password",value:o,onChange:t=>p(t.target.value),placeholder:"再次输入新密码",className:"w-full h-12 bg-white text-[14px] placeholder:text-[#999999] placeholder:text-[13px] border-b border-[#ECECEC] focus:border-[#0363E0] focus:outline-none transition-colors"}),o&&e.jsx(d,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#999999] cursor-pointer",onClick:()=>p("")})]}),e.jsx("div",{className:"text-[12px] text-[#999999] leading-5",children:"请设置6位及以上包含数字、字母和特殊符号中至少两种组合的密码"}),c&&e.jsx("div",{className:"text-[14px] text-red-500",children:c})]}),e.jsx("button",{className:"w-full h-[35px] mt-8 bg-black text-white rounded-full text-[14px] font-medium hover:bg-black/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",onClick:v,disabled:h,children:h?"保存中...":"保存"})]})]})}export{F as default};
