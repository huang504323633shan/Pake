import{c as Ee,r as u,j as r,X as nt,t as st}from"./index-CBGP0-9V.js";import{P as pe}from"./phone-8Q64_oBW.js";import{A as ye,a as Qe,b as Ge}from"./avatar-CZoOSk0v.js";import{u as qe}from"./uiStore-BW39O6R7.js";import{P as it}from"./plus-CHP_XERv.js";import{g as rt}from"./user-BeTEafWb.js";import{p as ot,g as at}from"./request-CRuLXg2Q.js";import{S as dt}from"./search-DxQ-bB_0.js";import{B as ct}from"./BottomNavigation-BvwDsqnO.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],$e=Ee("arrow-left",lt);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Ie=Ee("send",ut);function gt({contacts:t,onContactSelect:i,onMakeCall:d,onScrollDirectionChange:e}){const n=u.useRef(null),a=u.useRef(0),[l,m]=u.useState({}),[h,G]=u.useState(!1),[w,R]=u.useState(""),[O,X]=u.useState("");console.log("contacts",t);const N=[...t].sort((g,b)=>g.contactNickname.localeCompare(b.contactNickname,"zh-CN",{sensitivity:"accent"})),C=t.reduce((g,b)=>((b.contactDepartment?b.contactDepartment.split(",").map(U=>U.trim()):["未分组"]).forEach(U=>{g[U]||(g[U]=[]),g[U].push(b)}),g),{}),W=Object.keys(C).sort();if(Object.keys(l).length===0&&W.length>0){const g=W.reduce((b,F)=>(b[F]=!0,b),{});m(g)}return u.useEffect(()=>{const g=()=>{if(!n.current)return;const b=n.current.scrollTop,F=b>a.current?"down":"up";Math.abs(b-a.current)>50&&(e(F!=="down"),a.current=b)};return n.current&&n.current.addEventListener("scroll",g),()=>{n.current&&n.current.removeEventListener("scroll",g)}},[]),r.jsxs("div",{ref:n,className:"bg-gray-50  overflow-auto",style:{height:"calc(100vh - 200px)"},children:[N.map(g=>r.jsxs("div",{className:"flex items-center justify-between m-2 p-2  rounded-2xl bg-white border-b border-gray-100 active:bg-gray-50",children:[r.jsxs("div",{className:"flex items-center flex-1",onClick:()=>i(g),children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center mr-3 overflow-hidden flex-shrink-0",children:g.avatar?r.jsx("img",{src:g.contactAvatar||"/placeholder.svg",alt:g.contactNickname,className:"w-full h-full object-cover"}):r.jsx("span",{className:"text-lg font-medium text-gray-600",children:g.contactNickname.charAt(0)})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:"font-bold text-black  mb-1 truncate",children:g.contactNickname}),g.contactPosition&&r.jsx("p",{className:"text-sm text-gray-600 mb-1 truncate",children:g.contactPosition}),g.departments&&g.departments.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1",children:g.departments.map((b,F)=>r.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full truncate max-w-20",children:b},F))})]})]}),r.jsx("div",{className:"ml-3 flex-shrink-0",children:r.jsx("button",{className:`w-10 h-10 rounded-lg border flex items-center justify-center ${g.phone?"bg-white border-gray-300 text-gray-600 active:bg-gray-50":"bg-gray-200 border-gray-200 text-gray-400 cursor-not-allowed"}`,onClick:b=>{b.stopPropagation(),g.contactPhone&&(R(g.contactPhone),X(g.contactNickname),G(!0))},disabled:!g.contactPhone,children:r.jsx(pe,{className:"h-5 w-5"})})})]},g.id)),t.length===0&&r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-center text-gray-500",children:r.jsx("p",{children:"暂无联系人"})})}),r.jsx("div",{className:"h-30"}),h&&r.jsx("div",{className:"fixed inset-0 bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[r.jsx("p",{className:"mb-4 flex items-center justify-center",children:"是否通过电话联系"}),r.jsx("p",{className:"mb-4 flex items-center justify-center",children:O}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{className:"px-4 py-2 border rounded-lg",onClick:()=>G(!1),children:"取消"}),r.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg",onClick:()=>{d(w),G(!1)},children:"确认"})]})]})})]})}function pt({contact:t,onBack:i,onMakeCall:d}){var e;return r.jsxs("div",{className:"flex flex-col h-screen bg-gray-100",children:[r.jsxs("div",{className:"flex justify-between items-center p-4 bg-white",children:[r.jsx("button",{onClick:i,className:"w-8 h-8 flex items-center justify-center",children:r.jsx($e,{className:"h-5 w-5 text-gray-600"})}),r.jsx("h1",{className:"text-lg font-medium",children:"个人信息"}),r.jsx("div",{className:"w-8 h-8 flex items-center justify-center"})]}),r.jsxs("div",{className:"bg-white mx-4 mt-4 rounded-lg p-6",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center mr-4 overflow-hidden",children:r.jsxs(ye,{className:"w-full h-full object-cover",children:[r.jsx(Qe,{src:t.contactAvatar||qe,alt:"头像"}),r.jsx(Ge,{children:(e=t==null?void 0:t.contactNickname)==null?void 0:e.slice(0,1)})]})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h2",{className:"text-xl font-medium",children:t.contactNickname}),t.company&&r.jsx("span",{className:"text-sm text-gray-500",children:t.company})]}),t.contactPosition&&r.jsx("p",{className:"text-gray-600 mb-2",children:t.contactPosition}),t.completeness&&r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 mr-2",children:r.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${t.completeness}%`}})}),r.jsxs("span",{className:"text-sm text-gray-600",children:[t.completeness,"%"]})]})]})]}),t.departments&&t.departments.length>0&&r.jsx("div",{className:"flex flex-wrap gap-2",children:t.departments.map((n,a)=>r.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:n},a))})]}),r.jsxs("div",{className:"bg-white mx-4 mt-4 rounded-lg p-4",children:[r.jsx("h3",{className:"text-lg font-medium mb-4",children:"联系方式"}),t.contactPhone&&r.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(pe,{className:"h-5 w-5 text-gray-400 mr-3"}),r.jsx("span",{className:"text-gray-900",children:t.contactPhone})]}),r.jsx("button",{className:"w-10 h-10 rounded-lg border border-gray-300 bg-white text-gray-600 flex items-center justify-center active:bg-gray-50",onClick:()=>d(t.contactPhone),children:r.jsx(pe,{className:"h-5 w-5"})})]})]})]})}function ht(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function mt(t){return(i,d,e)=>{if(ht())throw new Error("`startWorkerFromMain` should only be called from the main thread");if(typeof Worker>"u")throw new Error("Web workers not available. sqlite3 requires web workers to work.");t().then(({default:n})=>{let a=new n;a.postMessage({type:"init",buffers:[i,d]}),a.addEventListener("message",l=>{e.postMessage(l.data)})})}}function wt(t,i){const d=mt(i);return e=>{e.addEventListener("message",n=>{switch(n.data.type){case t:d(n.data.argBuffer,n.data.resultBuffer,e);break}})}}const ft=wt("__absurd:spawn-idb-worker",()=>Promise.resolve().then(function(){return zt}));var vt=Object.defineProperty,yt=Object.defineProperties,Gt=Object.getOwnPropertyDescriptors,ke=Object.getOwnPropertySymbols,bt=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable,he=(t,i,d)=>i in t?vt(t,i,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[i]=d,me=(t,i)=>{for(var d in i||(i={}))bt.call(i,d)&&he(t,d,i[d]);if(ke)for(var d of ke(i))Mt.call(i,d)&&he(t,d,i[d]);return t},we=(t,i)=>yt(t,Gt(i)),k=(t,i,d)=>(he(t,typeof i!="symbol"?i+"":i,d),d);const T={CONNECT_TIMEOUT:{code:-32300,message:"Connect timeout"},APPLICATION_ERROR:{code:-32500,message:"Application error"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"}};class St{constructor(i){k(this,"_currentEndpoint"),k(this,"_targetEndpoint"),k(this,"_events"),k(this,"_originOnmessage"),k(this,"_receiveMessage"),k(this,"onerror",null),k(this,"config"),k(this,"sendAdapter"),k(this,"receiveAdapter"),this._events={},this._currentEndpoint=i.currentEndpoint,this._targetEndpoint=i.targetEndpoint,this._originOnmessage=null,this.config=i.config,this.receiveAdapter=i.receiveAdapter,this.sendAdapter=i.sendAdapter;const d=e=>{const n=this.receiveAdapter?this.receiveAdapter(e):e.data;if(n&&typeof n.event=="string"){const a=this._events[n.event]||[];if(a.length){a.forEach(l=>{l(...n.args||[])});return}this.onerror&&this.onerror(we(me({},T.METHOD_NOT_FOUND),{data:n}))}};if(this._currentEndpoint.addEventListener){"start"in this._currentEndpoint&&this._currentEndpoint.start&&this._currentEndpoint.start(),this._currentEndpoint.addEventListener("message",d,!1),this._receiveMessage=d;return}this._originOnmessage=this._currentEndpoint.onmessage,this._currentEndpoint.onmessage=e=>{this._originOnmessage&&this._originOnmessage(e),d(e)},this._receiveMessage=this._currentEndpoint.onmessage}emit(i,...d){const e={event:i,args:d},n=this.sendAdapter?this.sendAdapter(e,this._targetEndpoint):{data:e},a=n.data||e,l=this.config?typeof this.config=="function"?this.config(a,this._targetEndpoint)||{}:this.config||{}:{};Array.isArray(n.transfer)&&n.transfer.length&&(l.transfer=n.transfer),this._targetEndpoint.postMessage(a,l)}on(i,d){this._events[i]||(this._events[i]=[]),this._events[i].push(d)}off(i,d){if(!this._events[i])return;if(!d){this._events[i]=[];return}const e=this._events[i]||[];this._events[i]=e.filter(n=>n!==d)}destroy(){if(this._currentEndpoint.removeEventListener){this._currentEndpoint.removeEventListener("message",this._receiveMessage,!1);return}try{this._currentEndpoint.onmessage=this._originOnmessage}catch(i){console.warn(i)}}}const z=class{constructor(t){k(this,"_event"),k(this,"_methods",{}),k(this,"_timeout",0),k(this,"_$connect",null),this._event=t.event,this._timeout=t.timeout||0,t.methods&&Object.entries(t.methods).forEach(([i,d])=>{this.registerMethod(i,d)}),this._event.onerror=i=>{const{code:d,message:e,data:n}=i;if(n.event&&Array.isArray(n.args)&&n.args.length){const a=n.args[0],l=this._getAckEventName(a.method),m={jsonrpc:"2.0",id:a==null?void 0:a.id,error:{code:d,message:e,data:a}};this._event.emit(l,m)}else console.error(i)},this.connect()}static uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const i=Math.random()*16|0;return(t=="x"?i:i&3|8).toString(16)})}_getSynEventName(t){return`${z.EVENT.SYN_SIGN}${t}`}_getAckEventName(t){return`${z.EVENT.ACK_SIGN}${t}`}connect(t){return this._$connect?this._$connect:(this._$connect=new Promise((i,d)=>{const e=t||this._timeout;let n;e&&(n=setTimeout(()=>{const w=we(me({},T.TIMEOUT),{data:{timeout:e}});d(w)},e));const a=z.EVENT.CONNECT,l=this._getAckEventName(a),m=this._getSynEventName(a),h=()=>{clearTimeout(n),i()};this._event.on(l,h);const G=()=>{this._event.emit(l),h()};this._event.on(m,G),this._event.emit(m)}),this._$connect)}registerMethod(t,i){if(this._methods[t])throw new Error(`${t} already registered`);this._methods[t]=i;const d=this._getSynEventName(t),e=n=>{const a=this._getAckEventName(t);if(!n.id){i(...n.params);return}Promise.resolve(i(...n.params)).then(l=>{const m={jsonrpc:"2.0",result:l,id:n.id};this._event.emit(a,m)}).catch(l=>{const m={jsonrpc:"2.0",id:n.id,error:{code:(l==null?void 0:l.code)||T.APPLICATION_ERROR.code,message:(l==null?void 0:l.message)||T.APPLICATION_ERROR.message,data:null}};this._event.emit(a,m)})};this._event.on(d,e)}removeMethod(t){this._methods[t]||delete this._methods[t];const i=this._getSynEventName(t);this._event.off(i)}invoke(t,...i){return new Promise((d,e)=>{const n=i[i.length-1],a=n&&typeof n=="object"&&(Reflect.has(n,"isNotify")||Reflect.has(n,"timeout")),l=a?n:{isNotify:!1,timeout:0},m=a?i.slice(0,-1):i,h=this._getSynEventName(t),G=z.uuid(),w={jsonrpc:"2.0",method:t,params:m,id:G};if(this._event.emit(h,w),l.isNotify)d(void 0);else{const R=this._getAckEventName(t),O=l.timeout||this._timeout;let X;O&&(X=setTimeout(()=>{const C=we(me({},T.CONNECT_TIMEOUT),{data:{timeout:O}});e(C)},O));const N=C=>{C.id===G&&(clearTimeout(X),this._event.off(R,N),C.error?e(C.error):d(C.result))};this._event.on(R,N)}})}destroy(){Object.entries(this._methods).forEach(([d])=>{const e=this._getSynEventName(d);this._event.off(e)});const t=this._getAckEventName(z.EVENT.CONNECT),i=this._getSynEventName(z.EVENT.CONNECT);this._event.off(i),this._event.off(t),this._event.destroy&&this._event.destroy()}};let be=z;k(be,"CODES",T);k(be,"EVENT",{SYN_SIGN:"syn:",ACK_SIGN:"ack:",CONNECT:"__rpc_connect_event",SYNC_METHODS:"__rpc_sync_methods_event"});const xt={ErrorDBTimeout:10003};var ce;(function(t){t.Login="Login",t.OnConnectFailed="OnConnectFailed",t.OnConnectSuccess="OnConnectSuccess",t.OnConnecting="OnConnecting",t.OnKickedOffline="OnKickedOffline",t.OnSelfInfoUpdated="OnSelfInfoUpdated",t.OnUserTokenExpired="OnUserTokenExpired",t.OnUserTokenInvalid="OnUserTokenInvalid",t.OnProgress="OnProgress",t.OnRecvNewMessage="OnRecvNewMessage",t.OnRecvNewMessages="OnRecvNewMessages",t.OnRecvOnlineOnlyMessage="OnRecvOnlineOnlyMessage",t.OnRecvOfflineNewMessage="onRecvOfflineNewMessage",t.OnRecvOnlineOnlyMessages="OnRecvOnlineOnlyMessages",t.OnRecvOfflineNewMessages="onRecvOfflineNewMessages",t.OnRecvMessageRevoked="OnRecvMessageRevoked",t.OnNewRecvMessageRevoked="OnNewRecvMessageRevoked",t.OnRecvC2CReadReceipt="OnRecvC2CReadReceipt",t.OnRecvGroupReadReceipt="OnRecvGroupReadReceipt",t.OnConversationChanged="OnConversationChanged",t.OnNewConversation="OnNewConversation",t.OnConversationUserInputStatusChanged="OnConversationUserInputStatusChanged",t.OnSyncServerFailed="OnSyncServerFailed",t.OnSyncServerFinish="OnSyncServerFinish",t.OnSyncServerProgress="OnSyncServerProgress",t.OnSyncServerStart="OnSyncServerStart",t.OnTotalUnreadMessageCountChanged="OnTotalUnreadMessageCountChanged",t.OnBlackAdded="OnBlackAdded",t.OnBlackDeleted="OnBlackDeleted",t.OnFriendApplicationAccepted="OnFriendApplicationAccepted",t.OnFriendApplicationAdded="OnFriendApplicationAdded",t.OnFriendApplicationDeleted="OnFriendApplicationDeleted",t.OnFriendApplicationRejected="OnFriendApplicationRejected",t.OnFriendInfoChanged="OnFriendInfoChanged",t.OnFriendAdded="OnFriendAdded",t.OnFriendDeleted="OnFriendDeleted",t.OnJoinedGroupAdded="OnJoinedGroupAdded",t.OnJoinedGroupDeleted="OnJoinedGroupDeleted",t.OnGroupDismissed="OnGroupDismissed",t.OnGroupMemberAdded="OnGroupMemberAdded",t.OnGroupMemberDeleted="OnGroupMemberDeleted",t.OnGroupApplicationAdded="OnGroupApplicationAdded",t.OnGroupApplicationDeleted="OnGroupApplicationDeleted",t.OnGroupInfoChanged="OnGroupInfoChanged",t.OnGroupMemberInfoChanged="OnGroupMemberInfoChanged",t.OnGroupApplicationAccepted="OnGroupApplicationAccepted",t.OnGroupApplicationRejected="OnGroupApplicationRejected",t.UploadComplete="UploadComplete",t.OnRecvCustomBusinessMessage="OnRecvCustomBusinessMessage",t.OnUserStatusChanged="OnUserStatusChanged",t.OnUploadLogsProgress="OnUploadLogsProgress",t.OnReceiveNewInvitation="OnReceiveNewInvitation",t.OnInviteeAccepted="OnInviteeAccepted",t.OnInviteeRejected="OnInviteeRejected",t.OnInvitationCancelled="OnInvitationCancelled",t.OnHangUp="OnHangUp",t.OnInvitationTimeout="OnInvitationTimeout",t.OnInviteeAcceptedByOtherDevice="OnInviteeAcceptedByOtherDevice",t.OnInviteeRejectedByOtherDevice="OnInviteeRejectedByOtherDevice",t.OnStreamChange="OnStreamChange",t.OnRoomParticipantConnected="OnRoomParticipantConnected",t.OnRoomParticipantDisconnected="OnRoomParticipantDisconnected",t.OnReceiveCustomSignal="OnReceiveCustomSignal",t.UnUsedEvent="UnUsedEvent"})(ce||(ce={}));let L,V,et=!1;function It(){if(typeof Worker<"u"&&"type"in Worker.prototype)return!0;try{const t=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(t);return new Worker(i,{type:"module"}),URL.revokeObjectURL(i),!0}catch{return!1}}function Me(){if(typeof window>"u")return;const t=import.meta.url.includes(".vite/deps"),i=import.meta.url.includes("_nuxt/node_modules"),d=import.meta.url.includes(".q-cache"),e=It();let n=e?new URL("/assets/worker-DCcZ_X22.js",import.meta.url):new URL("/assets/worker-legacy-s32OZpl2.js",import.meta.url);t&&(n=n.href.replace(".vite/deps","@openim/wasm-client-sdk/lib")),i&&(n=n.href.replace(".cache/vite/client/deps","@openim/wasm-client-sdk/lib")),d&&(n=n.href.replace(/\.q-cache\/dev-spa\/[^/]+\/deps/,"@openim/wasm-client-sdk/lib")),V=new Worker(n,{type:e?"module":"classic"}),ft(V),L=new be({event:new St({currentEndpoint:V,targetEndpoint:V})})}function kt(){L&&(L.destroy(),L=void 0),V&&(V.terminate(),V=void 0)}Me();function tt(t){if(t.code===-32300)return kt(),JSON.stringify({data:"",errCode:xt.ErrorDBTimeout,errMsg:"database maybe damaged"});throw t}function q(...t){et&&console.info(...t)}function s(t,i,d=!0){return q(`=> (database api) registe ${i??t}`),async(...e)=>{if((!L||!V)&&Me(),!!L)try{q(`=> (invoked by go wasm) run ${i??t} method with args ${JSON.stringify(e)}`);const n=await L.invoke(t,...e,{timeout:5e6});return q(`=> (invoked by go wasm) run ${i??t} method with response `,JSON.stringify(n)),d?JSON.stringify(n):n}catch(n){tt(n)}}}function Nt(t=!0){L&&(et=t,window.wasmOpen=s("wasmOpen"),window.wasmClose=s("wasmClose"),window.wasmRead=s("wasmRead","wasmRead",!1),window.getUpload=s("getUpload"),window.insertUpload=s("insertUpload"),window.updateUpload=s("updateUpload"),window.deleteUpload=s("deleteUpload"),window.fileMapSet=s("fileMapSet"),window.fileMapClear=s("fileMapClear"),window.setSqlWasmPath=s("setSqlWasmPath"),window.initDB=s("initDB"),window.close=s("close"),window.getMessage=s("getMessage"),window.getMultipleMessage=s("getMultipleMessage"),window.getSendingMessageList=s("getSendingMessageList"),window.getNormalMsgSeq=s("getNormalMsgSeq"),window.updateMessageTimeAndStatus=s("updateMessageTimeAndStatus"),window.updateMessage=s("updateMessage"),window.updateMessageBySeq=s("updateMessageBySeq"),window.updateColumnsMessage=s("updateColumnsMessage"),window.insertMessage=s("insertMessage"),window.batchInsertMessageList=s("batchInsertMessageList"),window.getMessageList=s("getMessageList"),window.getMessageListNoTime=s("getMessageListNoTime"),window.messageIfExists=s("messageIfExists"),window.messageIfExistsBySeq=s("messageIfExistsBySeq"),window.getAbnormalMsgSeq=s("getAbnormalMsgSeq"),window.getAbnormalMsgSeqList=s("getAbnormalMsgSeqList"),window.batchInsertExceptionMsg=s("batchInsertExceptionMsg"),window.searchMessageByKeyword=s("searchMessageByKeyword"),window.searchMessageByContentType=s("searchMessageByContentType"),window.searchMessageByContentTypeAndKeyword=s("searchMessageByContentTypeAndKeyword"),window.updateMsgSenderNickname=s("updateMsgSenderNickname"),window.updateMsgSenderFaceURL=s("updateMsgSenderFaceURL"),window.updateMsgSenderFaceURLAndSenderNickname=s("updateMsgSenderFaceURLAndSenderNickname"),window.getMsgSeqByClientMsgID=s("getMsgSeqByClientMsgID"),window.getMsgSeqListByGroupID=s("getMsgSeqListByGroupID"),window.getMsgSeqListByPeerUserID=s("getMsgSeqListByPeerUserID"),window.getMsgSeqListBySelfUserID=s("getMsgSeqListBySelfUserID"),window.deleteAllMessage=s("deleteAllMessage"),window.getAllUnDeleteMessageSeqList=s("getAllUnDeleteMessageSeqList"),window.updateSingleMessageHasRead=s("updateSingleMessageHasRead"),window.updateGroupMessageHasRead=s("updateGroupMessageHasRead"),window.updateMessageStatusBySourceID=s("updateMessageStatusBySourceID"),window.getAlreadyExistSeqList=s("getAlreadyExistSeqList"),window.getLatestValidServerMessage=s("getLatestValidServerMessage"),window.getMessageBySeq=s("getMessageBySeq"),window.getMessagesByClientMsgIDs=s("getMessagesByClientMsgIDs"),window.getMessagesBySeqs=s("getMessagesBySeqs"),window.getConversationNormalMsgSeq=s("getConversationNormalMsgSeq"),window.checkConversationNormalMsgSeq=s("getConversationNormalMsgSeq"),window.getConversationPeerNormalMsgSeq=s("getConversationPeerNormalMsgSeq"),window.deleteConversationAllMessages=s("deleteConversationAllMessages"),window.markDeleteConversationAllMessages=s("markDeleteConversationAllMessages"),window.getUnreadMessage=s("getUnreadMessage"),window.markConversationMessageAsReadBySeqs=s("markConversationMessageAsReadBySeqs"),window.markConversationMessageAsReadDB=s("markConversationMessageAsRead"),window.deleteConversationMsgs=s("deleteConversationMsgs"),window.markConversationAllMessageAsRead=s("markConversationAllMessageAsRead"),window.searchAllMessageByContentType=s("searchAllMessageByContentType"),window.insertSendingMessage=s("insertSendingMessage"),window.deleteSendingMessage=s("deleteSendingMessage"),window.getAllSendingMessages=s("getAllSendingMessages"),window.getAllConversationListDB=s("getAllConversationList"),window.getAllConversationListToSync=s("getAllConversationListToSync"),window.getHiddenConversationList=s("getHiddenConversationList"),window.getConversation=s("getConversation"),window.getMultipleConversationDB=s("getMultipleConversation"),window.updateColumnsConversation=s("updateColumnsConversation"),window.updateConversation=s("updateColumnsConversation","updateConversation"),window.updateConversationForSync=s("updateColumnsConversation","updateConversationForSync"),window.decrConversationUnreadCount=s("decrConversationUnreadCount"),window.batchInsertConversationList=s("batchInsertConversationList"),window.insertConversation=s("insertConversation"),window.getTotalUnreadMsgCountDB=s("getTotalUnreadMsgCount"),window.getConversationByUserID=s("getConversationByUserID"),window.getConversationListSplitDB=s("getConversationListSplit"),window.deleteConversation=s("deleteConversation"),window.deleteAllConversation=s("deleteAllConversation"),window.batchUpdateConversationList=s("batchUpdateConversationList"),window.conversationIfExists=s("conversationIfExists"),window.resetConversation=s("resetConversation"),window.resetAllConversation=s("resetAllConversation"),window.clearConversation=s("clearConversation"),window.clearAllConversation=s("clearAllConversation"),window.setConversationDraftDB=s("setConversationDraft"),window.removeConversationDraft=s("removeConversationDraft"),window.unPinConversation=s("unPinConversation"),window.incrConversationUnreadCount=s("incrConversationUnreadCount"),window.setMultipleConversationRecvMsgOpt=s("setMultipleConversationRecvMsgOpt"),window.getAllSingleConversationIDList=s("getAllSingleConversationIDList"),window.findAllUnreadConversationConversationID=s("findAllUnreadConversationConversationID"),window.getAllConversationIDList=s("getAllConversationIDList"),window.getAllConversations=s("getAllConversations"),window.searchConversations=s("searchConversations"),window.getLatestActiveMessage=s("getLatestActiveMessage"),window.getLoginUser=s("getLoginUser"),window.insertLoginUser=s("insertLoginUser"),window.updateLoginUser=s("updateLoginUser"),window.getStrangerInfo=s("getStrangerInfo"),window.setStrangerInfo=s("setStrangerInfo"),window.getAppSDKVersion=s("getAppSDKVersion"),window.setAppSDKVersion=s("setAppSDKVersion"),window.getVersionSync=s("getVersionSync"),window.setVersionSync=s("setVersionSync"),window.deleteVersionSync=s("deleteVersionSync"),window.getJoinedSuperGroupList=s("getJoinedSuperGroupList"),window.getJoinedSuperGroupIDList=s("getJoinedSuperGroupIDList"),window.getSuperGroupInfoByGroupID=s("getSuperGroupInfoByGroupID"),window.deleteSuperGroup=s("deleteSuperGroup"),window.insertSuperGroup=s("insertSuperGroup"),window.updateSuperGroup=s("updateSuperGroup"),window.deleteConversationUnreadMessageList=s("deleteConversationUnreadMessageList"),window.batchInsertConversationUnreadMessageList=s("batchInsertConversationUnreadMessageList"),window.superGroupGetMessage=s("superGroupGetMessage"),window.superGroupGetMultipleMessage=s("superGroupGetMultipleMessage"),window.superGroupGetNormalMinSeq=s("superGroupGetNormalMinSeq"),window.getSuperGroupNormalMsgSeq=s("getSuperGroupNormalMsgSeq"),window.superGroupUpdateMessageTimeAndStatus=s("superGroupUpdateMessageTimeAndStatus"),window.superGroupUpdateMessage=s("superGroupUpdateMessage"),window.superGroupInsertMessage=s("superGroupInsertMessage"),window.superGroupBatchInsertMessageList=s("superGroupBatchInsertMessageList"),window.superGroupGetMessageListNoTime=s("superGroupGetMessageListNoTime"),window.superGroupGetMessageList=s("superGroupGetMessageList"),window.superGroupUpdateColumnsMessage=s("superGroupUpdateColumnsMessage"),window.superGroupDeleteAllMessage=s("superGroupDeleteAllMessage"),window.superGroupSearchMessageByKeyword=s("superGroupSearchMessageByKeyword"),window.superGroupSearchMessageByContentType=s("superGroupSearchMessageByContentType"),window.superGroupSearchMessageByContentTypeAndKeyword=s("superGroupSearchMessageByContentTypeAndKeyword"),window.superGroupUpdateMessageStatusBySourceID=s("superGroupUpdateMessageStatusBySourceID"),window.superGroupGetSendingMessageList=s("superGroupGetSendingMessageList"),window.superGroupUpdateGroupMessageHasRead=s("superGroupUpdateGroupMessageHasRead"),window.superGroupGetMsgSeqByClientMsgID=s("superGroupGetMsgSeqByClientMsgID"),window.superGroupUpdateMsgSenderFaceURLAndSenderNickname=s("superGroupUpdateMsgSenderFaceURLAndSenderNickname"),window.superGroupSearchAllMessageByContentType=s("superGroupSearchAllMessageByContentType"),window.exec=s("exec"),window.getRowsModified=s("getRowsModified"),window.exportDB=async()=>{if((!L||!V)&&Me(),!!L)try{q("=> (invoked by go wasm) run exportDB method ");const i=await L.invoke("exportDB",void 0,{timeout:5e3});return q("=> (invoked by go wasm) run exportDB method with response ",JSON.stringify(i)),i}catch(i){tt(i)}},window.getBlackListDB=s("getBlackList"),window.getBlackListUserID=s("getBlackListUserID"),window.getBlackInfoByBlockUserID=s("getBlackInfoByBlockUserID"),window.getBlackInfoList=s("getBlackInfoList"),window.insertBlack=s("insertBlack"),window.deleteBlack=s("deleteBlack"),window.updateBlack=s("updateBlack"),window.insertFriendRequest=s("insertFriendRequest"),window.deleteFriendRequestBothUserID=s("deleteFriendRequestBothUserID"),window.updateFriendRequest=s("updateFriendRequest"),window.getRecvFriendApplication=s("getRecvFriendApplication"),window.getSendFriendApplication=s("getSendFriendApplication"),window.getFriendApplicationByBothID=s("getFriendApplicationByBothID"),window.getBothFriendReq=s("getBothFriendReq"),window.insertFriend=s("insertFriend"),window.deleteFriendDB=s("deleteFriend"),window.updateFriend=s("updateFriend"),window.getAllFriendList=s("getAllFriendList"),window.searchFriendList=s("searchFriendList"),window.getFriendInfoByFriendUserID=s("getFriendInfoByFriendUserID"),window.getFriendInfoList=s("getFriendInfoList"),window.getPageFriendList=s("getPageFriendList"),window.updateColumnsFriend=s("updateColumnsFriend"),window.getFriendListCount=s("getFriendListCount"),window.batchInsertFriend=s("batchInsertFriend"),window.deleteAllFriend=s("deleteAllFriend"),window.insertGroup=s("insertGroup"),window.deleteGroup=s("deleteGroup"),window.updateGroup=s("updateGroup"),window.getJoinedGroupListDB=s("getJoinedGroupList"),window.getGroupInfoByGroupID=s("getGroupInfoByGroupID"),window.getAllGroupInfoByGroupIDOrGroupName=s("getAllGroupInfoByGroupIDOrGroupName"),window.subtractMemberCount=s("subtractMemberCount"),window.addMemberCount=s("addMemberCount"),window.getJoinedWorkingGroupIDList=s("getJoinedWorkingGroupIDList"),window.getJoinedWorkingGroupList=s("getJoinedWorkingGroupList"),window.getGroupMemberAllGroupIDs=s("getGroupMemberAllGroupIDs"),window.getUserJoinedGroupIDs=s("getUserJoinedGroupIDs"),window.getGroups=s("getGroups"),window.getGroupMemberListByUserIDs=s("getGroupMemberListByUserIDs"),window.batchInsertGroup=s("batchInsertGroup"),window.deleteAllGroup=s("deleteAllGroup"),window.insertGroupRequest=s("insertGroupRequest"),window.deleteGroupRequest=s("deleteGroupRequest"),window.updateGroupRequest=s("updateGroupRequest"),window.getSendGroupApplication=s("getSendGroupApplication"),window.insertAdminGroupRequest=s("insertAdminGroupRequest"),window.deleteAdminGroupRequest=s("deleteAdminGroupRequest"),window.updateAdminGroupRequest=s("updateAdminGroupRequest"),window.getAdminGroupApplication=s("getAdminGroupApplication"),window.getGroupMemberInfoByGroupIDUserID=s("getGroupMemberInfoByGroupIDUserID"),window.getAllGroupMemberList=s("getAllGroupMemberList"),window.getAllGroupMemberUserIDList=s("getAllGroupMemberUserIDList"),window.getGroupMemberCount=s("getGroupMemberCount"),window.getGroupSomeMemberInfo=s("getGroupSomeMemberInfo"),window.getGroupAdminID=s("getGroupAdminID"),window.getGroupMemberListByGroupID=s("getGroupMemberListByGroupID"),window.getGroupMemberListSplit=s("getGroupMemberListSplit"),window.getGroupMemberOwnerAndAdminDB=s("getGroupMemberOwnerAndAdmin"),window.getGroupMemberOwner=s("getGroupMemberOwner"),window.getGroupMemberListSplitByJoinTimeFilter=s("getGroupMemberListSplitByJoinTimeFilter"),window.getGroupOwnerAndAdminByGroupID=s("getGroupOwnerAndAdminByGroupID"),window.getGroupMemberUIDListByGroupID=s("getGroupMemberUIDListByGroupID"),window.insertGroupMember=s("insertGroupMember"),window.batchInsertGroupMember=s("batchInsertGroupMember"),window.deleteGroupMember=s("deleteGroupMember"),window.deleteGroupAllMembers=s("deleteGroupAllMembers"),window.updateGroupMember=s("updateGroupMember"),window.updateGroupMemberField=s("updateGroupMemberField"),window.searchGroupMembersDB=s("searchGroupMembers","searchGroupMembersDB"),window.batchInsertTempCacheMessageList=s("batchInsertTempCacheMessageList"),window.InsertTempCacheMessage=s("InsertTempCacheMessage"),window.getNotificationAllSeqs=s("getNotificationAllSeqs"),window.setNotificationSeq=s("setNotificationSeq"),window.batchInsertNotificationSeq=s("batchInsertNotificationSeq"),window.getExistedTables=s("getExistedTables"))}const Ct=L==null?void 0:L.connect(5e3);class Lt{constructor(){this.events={}}emit(i,d){return this.events[i]&&this.events[i].forEach(e=>e(d)),this}on(i,d){return this.events[i]?this.events[i].push(d):this.events[i]=[d],this}off(i,d){if(i&&typeof d=="function"&&this.events[i]){const e=this.events[i];if(!e||e.length===0)return;const n=e.findIndex(a=>a===d);n!==-1&&e.splice(n,1)}return this}}let ae;const Zt=new Uint8Array(16);function Rt(){if(!ae&&(ae=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ae))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ae(Zt)}const S=[];for(let t=0;t<256;++t)S.push((t+256).toString(16).slice(1));function Ot(t,i=0){return(S[t[i+0]]+S[t[i+1]]+S[t[i+2]]+S[t[i+3]]+"-"+S[t[i+4]]+S[t[i+5]]+"-"+S[t[i+6]]+S[t[i+7]]+"-"+S[t[i+8]]+S[t[i+9]]+"-"+S[t[i+10]]+S[t[i+11]]+S[t[i+12]]+S[t[i+13]]+S[t[i+14]]+S[t[i+15]]).toLowerCase()}const At=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var Ne={randomUUID:At};function o(t,i,d){if(Ne.randomUUID&&!t)return Ne.randomUUID();t=t||{};const e=t.random||(t.rng||Rt)();return e[6]=e[6]&15|64,e[8]=e[8]&63|128,Ot(e)}async function Dt(t){return new Promise(i=>{const d=setTimeout(()=>{clearTimeout(d),i(null)},t)})}function ge(t,i){return`font-size:14px; background:${t??"#ffffff"}; color:${i??"#000000"}; border-radius:4px; padding-inline:4px;`}let Ce=!1,P,Xt;const Wt="openim-wasm-cache";async function Ut(t){if(Ce)return null;if(typeof window>"u")return Promise.resolve(null);P=new Go;let i;try{if("instantiateStreaming"in WebAssembly)i=await WebAssembly.instantiateStreaming(Ze(t),P.importObject);else{const d=await Ze(t).then(e=>e.arrayBuffer());i=await WebAssembly.instantiate(d,P.importObject)}P.run(i.instance)}catch(d){return console.error("Failed to initialize WASM:",d),null}return await Dt(100),Ce=!0,P}function Le(){return P}function Ft(){return Xt}async function Ze(t){if(!("caches"in window))return fetch(t);const i=async()=>{const n=await fetch(t,{method:"HEAD"}),a=n.headers.get("ETag"),l=n.headers.get("Last-Modified");return n.ok&&(a!==(e==null?void 0:e.headers.get("ETag"))||l!==(e==null?void 0:e.headers.get("Last-Modified")))},d=await caches.open(Wt),e=await d.match(t);return e&&!await i()?e:Bt(t,d)}async function Bt(t,i){const d=await fetch(t,{cache:"no-cache"});try{await i.put(t,d.clone())}catch{console.warn("Failed to put cache")}return d}var Re;(function(t){t[t.Normal=0]="Normal",t[t.NotReceive=1]="NotReceive",t[t.NotNotify=2]="NotNotify"})(Re||(Re={}));var Oe;(function(t){t[t.AddFriendAllowed=0]="AddFriendAllowed",t[t.AddFriendAllowedNoReview=1]="AddFriendAllowedNoReview",t[t.AddFriendDenied=2]="AddFriendDenied"})(Oe||(Oe={}));var Ae;(function(t){t[t.Allowed=0]="Allowed",t[t.NotAllowed=1]="NotAllowed"})(Ae||(Ae={}));var De;(function(t){t[t.Group=2]="Group",t[t.WorkingGroup=2]="WorkingGroup"})(De||(De={}));var Xe;(function(t){t[t.Invitation=2]="Invitation",t[t.Search=3]="Search",t[t.QrCode=4]="QrCode"})(Xe||(Xe={}));var We;(function(t){t[t.Normal=20]="Normal",t[t.Admin=60]="Admin",t[t.Owner=100]="Owner"})(We||(We={}));var Ue;(function(t){t[t.ApplyNeedInviteNot=0]="ApplyNeedInviteNot",t[t.AllNeed=1]="AllNeed",t[t.AllNot=2]="AllNot"})(Ue||(Ue={}));var Fe;(function(t){t[t.Sending=1]="Sending",t[t.Succeed=2]="Succeed",t[t.Failed=3]="Failed"})(Fe||(Fe={}));var Be;(function(t){t[t.iOS=1]="iOS",t[t.Android=2]="Android",t[t.Windows=3]="Windows",t[t.MacOSX=4]="MacOSX",t[t.Web=5]="Web",t[t.Linux=7]="Linux",t[t.AndroidPad=8]="AndroidPad",t[t.iPad=9]="iPad"})(Be||(Be={}));var Ve;(function(t){t[t.Verbose=6]="Verbose",t[t.Debug=5]="Debug",t[t.Info=4]="Info",t[t.Warn=3]="Warn",t[t.Error=2]="Error",t[t.Fatal=1]="Fatal",t[t.Panic=0]="Panic"})(Ve||(Ve={}));var _e;(function(t){t[t.Unprocessed=0]="Unprocessed",t[t.Agree=1]="Agree",t[t.Reject=-1]="Reject"})(_e||(_e={}));var je;(function(t){t[t.TextMessage=101]="TextMessage",t[t.PictureMessage=102]="PictureMessage",t[t.VoiceMessage=103]="VoiceMessage",t[t.VideoMessage=104]="VideoMessage",t[t.FileMessage=105]="FileMessage",t[t.AtTextMessage=106]="AtTextMessage",t[t.MergeMessage=107]="MergeMessage",t[t.CardMessage=108]="CardMessage",t[t.LocationMessage=109]="LocationMessage",t[t.CustomMessage=110]="CustomMessage",t[t.TypingMessage=113]="TypingMessage",t[t.QuoteMessage=114]="QuoteMessage",t[t.FaceMessage=115]="FaceMessage",t[t.FriendAdded=1201]="FriendAdded",t[t.OANotification=1400]="OANotification",t[t.GroupCreated=1501]="GroupCreated",t[t.GroupInfoUpdated=1502]="GroupInfoUpdated",t[t.MemberQuit=1504]="MemberQuit",t[t.GroupOwnerTransferred=1507]="GroupOwnerTransferred",t[t.MemberKicked=1508]="MemberKicked",t[t.MemberInvited=1509]="MemberInvited",t[t.MemberEnter=1510]="MemberEnter",t[t.GroupDismissed=1511]="GroupDismissed",t[t.GroupMemberMuted=1512]="GroupMemberMuted",t[t.GroupMemberCancelMuted=1513]="GroupMemberCancelMuted",t[t.GroupMuted=1514]="GroupMuted",t[t.GroupCancelMuted=1515]="GroupCancelMuted",t[t.GroupAnnouncementUpdated=1519]="GroupAnnouncementUpdated",t[t.GroupNameUpdated=1520]="GroupNameUpdated",t[t.BurnMessageChange=1701]="BurnMessageChange",t[t.RevokeMessage=2101]="RevokeMessage"})(je||(je={}));var Je;(function(t){t[t.Single=1]="Single",t[t.Group=3]="Group",t[t.WorkingGroup=3]="WorkingGroup",t[t.Notification=4]="Notification"})(Je||(Je={}));var Ke;(function(t){t[t.Normal=0]="Normal",t[t.Banned=1]="Banned",t[t.Dismissed=2]="Dismissed",t[t.Muted=3]="Muted"})(Ke||(Ke={}));var fe;(function(t){t[t.AtNormal=0]="AtNormal",t[t.AtMe=1]="AtMe",t[t.AtAll=2]="AtAll",t[t.AtAllAtMe=3]="AtAllAtMe",t[t.AtGroupNotice=4]="AtGroupNotice"})(fe||(fe={}));var Ye;(function(t){t[t.All=0]="All",t[t.Owner=1]="Owner",t[t.Admin=2]="Admin",t[t.Normal=3]="Normal",t[t.AdminAndNormal=4]="AdminAndNormal",t[t.AdminAndOwner=5]="AdminAndOwner"})(Ye||(Ye={}));var ze;(function(t){t[t.isBlack=0]="isBlack",t[t.isFriend=1]="isFriend"})(ze||(ze={}));var He;(function(t){t[t.Logout=1]="Logout",t[t.Logging=2]="Logging",t[t.Logged=3]="Logged"})(He||(He={}));var Pe;(function(t){t[t.Online=1]="Online",t[t.Offline=0]="Offline"})(Pe||(Pe={}));var Te;(function(t){t[t.Read=0]="Read",t[t.UnRead=1]="UnRead"})(Te||(Te={}));var ve;(function(t){t[t.History=0]="History",t[t.Search=1]="Search"})(ve||(ve={}));class Vt extends Lt{constructor(i="/openIM.wasm",d=!0){super(),this.goExisted=!1,this.tryParse=!0,this.isLogStandardOutput=!0,this.login=async(e,n=o())=>{var a,l;this._logWrap(`SDK => (invoked by js) run login with args ${JSON.stringify({params:e,operationID:n})}`),await Ct,await this.wasmInitializedPromise,window.commonEventFunc(h=>{try{this._logWrap(`%cSDK =>%c received event %c${h}%c `,ge("#282828","#ffffff"),"","color: #4f2398;","");const G=JSON.parse(h);if(this.tryParse)try{G.data=JSON.parse(G.data)}catch{}this.emit(G.event,G)}catch(G){console.error(G)}});const m={platformID:e.platformID,apiAddr:e.apiAddr,wsAddr:e.wsAddr,dataDir:"./",logLevel:e.logLevel||5,isLogStandardOutput:(a=e.isLogStandardOutput)!==null&&a!==void 0?a:this.isLogStandardOutput,logFilePath:"./",isExternalExtensions:e.isExternalExtensions||!1};return this.tryParse=(l=e.tryParse)!==null&&l!==void 0?l:!0,window.initSDK(n,JSON.stringify(m)),await window.login(n,e.userID,e.token)},this.logout=(e=o())=>(window.fileMapClear(),this._invoker("logout",window.logout,[e])),this.getAllConversationList=(e=o())=>this._invoker("getAllConversationList",window.getAllConversationList,[e]),this.getOneConversation=(e,n=o())=>this._invoker("getOneConversation",window.getOneConversation,[n,e.sessionType,e.sourceID]),this.getAdvancedHistoryMessageList=(e,n=o())=>this._invoker("getAdvancedHistoryMessageList",window.getAdvancedHistoryMessageList,[n,JSON.stringify(e)]),this.getAdvancedHistoryMessageListReverse=(e,n=o())=>this._invoker("getAdvancedHistoryMessageListReverse",window.getAdvancedHistoryMessageListReverse,[n,JSON.stringify(e)]),this.fetchSurroundingMessages=(e,n=o())=>this._invoker("fetchSurroundingMessages",window.fetchSurroundingMessages,[n,JSON.stringify(e)]),this.getSpecifiedGroupsInfo=(e,n=o())=>this._invoker("getSpecifiedGroupsInfo",window.getSpecifiedGroupsInfo,[n,JSON.stringify(e)]),this.deleteConversationAndDeleteAllMsg=(e,n=o())=>this._invoker("deleteConversationAndDeleteAllMsg",window.deleteConversationAndDeleteAllMsg,[n,e]),this.markConversationMessageAsRead=(e,n=o())=>this._invoker("markConversationMessageAsRead",window.markConversationMessageAsRead,[n,e]),this.sendGroupMessageReadReceipt=(e,n=o())=>this._invoker("sendGroupMessageReadReceipt",window.sendGroupMessageReadReceipt,[n,e.conversationID,JSON.stringify(e.clientMsgIDList)]),this.getGroupMessageReaderList=(e,n=o())=>this._invoker("getGroupMessageReaderList",window.getGroupMessageReaderList,[n,e.conversationID,e.clientMsgID,e.filter,e.offset,e.count]),this.getGroupMemberList=(e,n=o())=>this._invoker("getGroupMemberList",window.getGroupMemberList,[n,e.groupID,e.filter,e.offset,e.count]),this.createTextMessage=(e,n=o())=>this._invoker("createTextMessage",window.createTextMessage,[n,e],a=>a[0]),this.createImageMessageByURL=(e,n=o())=>this._invoker("createImageMessageByURL",window.createImageMessageByURL,[n,e.sourcePath,JSON.stringify(e.sourcePicture),JSON.stringify(e.bigPicture),JSON.stringify(e.snapshotPicture)],a=>a[0]),this.createImageMessageByFile=(e,n=o())=>(e.sourcePicture.uuid=`${e.sourcePicture.uuid}/${e.file.name}`,window.fileMapSet(e.sourcePicture.uuid,e.file),this._invoker("createImageMessageByFile",window.createImageMessageByURL,[n,e.sourcePath,JSON.stringify(e.sourcePicture),JSON.stringify(e.bigPicture),JSON.stringify(e.snapshotPicture)],a=>a[0])),this.createCustomMessage=(e,n=o())=>this._invoker("createCustomMessage",window.createCustomMessage,[n,e.data,e.extension,e.description],a=>a[0]),this.createQuoteMessage=(e,n=o())=>this._invoker("createQuoteMessage",window.createQuoteMessage,[n,e.text,e.message],a=>a[0]),this.createAdvancedQuoteMessage=(e,n=o())=>this._invoker("createAdvancedQuoteMessage",window.createAdvancedQuoteMessage,[n,e.text,JSON.stringify(e.message),JSON.stringify(e.messageEntityList)],a=>a[0]),this.createAdvancedTextMessage=(e,n=o())=>this._invoker("createAdvancedTextMessage",window.createAdvancedTextMessage,[n,e.text,JSON.stringify(e.messageEntityList)],a=>a[0]),this.sendMessage=(e,n=o())=>{var a,l;const m=(a=e.offlinePushInfo)!==null&&a!==void 0?a:{title:"You have a new message.",desc:"",ex:"",iOSPushSound:"+1",iOSBadgeCount:!0};return this._invoker("sendMessage",window.sendMessage,[n,JSON.stringify(e.message),e.recvID,e.groupID,JSON.stringify(m),(l=e.isOnlineOnly)!==null&&l!==void 0?l:!1])},this.sendMessageNotOss=(e,n=o())=>{var a,l;const m=(a=e.offlinePushInfo)!==null&&a!==void 0?a:{title:"You have a new message.",desc:"",ex:"",iOSPushSound:"+1",iOSBadgeCount:!0};return this._invoker("sendMessageNotOss",window.sendMessageNotOss,[n,JSON.stringify(e.message),e.recvID,e.groupID,JSON.stringify(m),(l=e.isOnlineOnly)!==null&&l!==void 0?l:!1])},this.setMessageLocalEx=(e,n=o())=>this._invoker("setMessageLocalEx",window.setMessageLocalEx,[n,e.conversationID,e.clientMsgID,e.localEx]),this.getHistoryMessageListReverse=(e,n=o())=>this._invoker("getHistoryMessageListReverse",window.getHistoryMessageListReverse,[n,JSON.stringify(e)]),this.revokeMessage=(e,n=o())=>this._invoker("revokeMessage",window.revokeMessage,[n,e.conversationID,e.clientMsgID]),this.setConversation=(e,n=o())=>this._invoker("setConversation",window.setConversation,[n,e.conversationID,JSON.stringify(e)]),this.setConversationPrivateChat=(e,n=o())=>this._invoker("setConversationPrivateChat",window.setConversation,[n,e.conversationID,JSON.stringify({isPrivateChat:e.isPrivate})]),this.setConversationBurnDuration=(e,n=o())=>this._invoker("setConversationBurnDuration",window.setConversation,[n,e.conversationID,JSON.stringify({burnDuration:e.burnDuration})]),this.getLoginStatus=(e=o())=>this._invoker("getLoginStatus",window.getLoginStatus,[e],n=>n[0]),this.setAppBackgroundStatus=(e,n=o())=>this._invoker("setAppBackgroundStatus",window.setAppBackgroundStatus,[n,e]),this.networkStatusChanged=(e=o())=>this._invoker("networkStatusChanged ",window.networkStatusChanged,[e]),this.getLoginUserID=(e=o())=>this._invoker("getLoginUserID",window.getLoginUserID,[e]),this.getSelfUserInfo=(e=o())=>this._invoker("getSelfUserInfo",window.getSelfUserInfo,[e]),this.getUsersInfo=(e,n=o())=>this._invoker("getUsersInfo",window.getUsersInfo,[n,JSON.stringify(e)]),this.SetSelfInfoEx=(e,n=o())=>this._invoker("SetSelfInfoEx",window.setSelfInfo,[n,JSON.stringify(e)]),this.setSelfInfo=(e,n=o())=>this._invoker("setSelfInfo",window.setSelfInfo,[n,JSON.stringify(e)]),this.createTextAtMessage=(e,n=o())=>{var a;return this._invoker("createTextAtMessage",window.createTextAtMessage,[n,e.text,JSON.stringify(e.atUserIDList),JSON.stringify(e.atUsersInfo),(a=JSON.stringify(e.message))!==null&&a!==void 0?a:""],l=>l[0])},this.createSoundMessageByURL=(e,n=o())=>this._invoker("createSoundMessageByURL",window.createSoundMessageByURL,[n,JSON.stringify(e)],a=>a[0]),this.createSoundMessageByFile=(e,n=o())=>(e.uuid=`${e.uuid}/${e.file.name}`,window.fileMapSet(e.uuid,e.file),this._invoker("createSoundMessageByFile",window.createSoundMessageByURL,[n,JSON.stringify(e)],a=>a[0])),this.createVideoMessageByURL=(e,n=o())=>this._invoker("createVideoMessageByURL",window.createVideoMessageByURL,[n,JSON.stringify(e)],a=>a[0]),this.createVideoMessageByFile=(e,n=o())=>(e.videoUUID=`${e.videoUUID}/${e.videoFile.name}`,e.snapshotUUID=`${e.snapshotUUID}/${e.snapshotFile.name}`,window.fileMapSet(e.videoUUID,e.videoFile),window.fileMapSet(e.snapshotUUID,e.snapshotFile),this._invoker("createVideoMessageByFile",window.createVideoMessageByURL,[n,JSON.stringify(e)],a=>a[0])),this.createFileMessageByURL=(e,n=o())=>this._invoker("createFileMessageByURL",window.createFileMessageByURL,[n,JSON.stringify(e)],a=>a[0]),this.createFileMessageByFile=(e,n=o())=>(e.uuid=`${e.uuid}/${e.file.name}`,window.fileMapSet(e.uuid,e.file),this._invoker("createFileMessageByFile",window.createFileMessageByURL,[n,JSON.stringify(e)],a=>a[0])),this.createMergerMessage=(e,n=o())=>this._invoker("createMergerMessage ",window.createMergerMessage,[n,JSON.stringify(e.messageList),e.title,JSON.stringify(e.summaryList)],a=>a[0]),this.createForwardMessage=(e,n=o())=>this._invoker("createForwardMessage ",window.createForwardMessage,[n,JSON.stringify(e)],a=>a[0]),this.createFaceMessage=(e,n=o())=>this._invoker("createFaceMessage ",window.createFaceMessage,[n,e.index,e.data],a=>a[0]),this.createLocationMessage=(e,n=o())=>this._invoker("createLocationMessage ",window.createLocationMessage,[n,e.description,e.longitude,e.latitude],a=>a[0]),this.createCardMessage=(e,n=o())=>this._invoker("createCardMessage ",window.createCardMessage,[n,JSON.stringify(e)],a=>a[0]),this.deleteMessageFromLocalStorage=(e,n=o())=>this._invoker("deleteMessageFromLocalStorage ",window.deleteMessageFromLocalStorage,[n,e.conversationID,e.clientMsgID]),this.deleteMessage=(e,n=o())=>this._invoker("deleteMessage ",window.deleteMessage,[n,e.conversationID,e.clientMsgID]),this.deleteAllConversationFromLocal=(e=o())=>this._invoker("deleteAllConversationFromLocal ",window.deleteAllConversationFromLocal,[e]),this.deleteAllMsgFromLocal=(e=o())=>this._invoker("deleteAllMsgFromLocal ",window.deleteAllMsgFromLocal,[e]),this.deleteAllMsgFromLocalAndSvr=(e=o())=>this._invoker("deleteAllMsgFromLocalAndSvr ",window.deleteAllMsgFromLocalAndSvr,[e]),this.insertSingleMessageToLocalStorage=(e,n=o())=>this._invoker("insertSingleMessageToLocalStorage ",window.insertSingleMessageToLocalStorage,[n,JSON.stringify(e.message),e.recvID,e.sendID]),this.insertGroupMessageToLocalStorage=(e,n=o())=>this._invoker("insertGroupMessageToLocalStorage ",window.insertGroupMessageToLocalStorage,[n,JSON.stringify(e.message),e.groupID,e.sendID]),this.typingStatusUpdate=(e,n=o())=>this._invoker("typingStatusUpdate ",window.typingStatusUpdate,[n,e.recvID,e.msgTip]),this.changeInputStates=(e,n=o())=>this._invoker("changeInputStates ",window.changeInputStates,[n,e.conversationID,e.focus]),this.getInputstates=(e,n=o())=>this._invoker("getInputstates ",window.getInputstates,[n,e.conversationID,e.userID]),this.clearConversationAndDeleteAllMsg=(e,n=o())=>this._invoker("clearConversationAndDeleteAllMsg ",window.clearConversationAndDeleteAllMsg,[n,e]),this.hideConversation=(e,n=o())=>this._invoker("hideConversation ",window.hideConversation,[n,e]),this.getConversationListSplit=(e,n=o())=>this._invoker("getConversationListSplit ",window.getConversationListSplit,[n,e.offset,e.count]),this.setConversationEx=(e,n=o())=>this._invoker("setConversationEx ",window.setConversation,[n,e.conversationID,JSON.stringify({ex:e.ex})]),this.getConversationIDBySessionType=(e,n=o())=>this._invoker("getConversationIDBySessionType ",window.getConversationIDBySessionType,[n,e.sourceID,e.sessionType]),this.getMultipleConversation=(e,n=o())=>this._invoker("getMultipleConversation ",window.getMultipleConversation,[n,JSON.stringify(e)]),this.deleteConversation=(e,n=o())=>this._invoker("deleteConversation ",window.deleteConversation,[n,e]),this.setConversationDraft=(e,n=o())=>this._invoker("setConversationDraft ",window.setConversationDraft,[n,e.conversationID,e.draftText]),this.pinConversation=(e,n=o())=>this._invoker("pinConversation ",window.setConversation,[n,e.conversationID,JSON.stringify({isPinned:e.isPinned})]),this.getTotalUnreadMsgCount=(e=o())=>this._invoker("getTotalUnreadMsgCount ",window.getTotalUnreadMsgCount,[e]),this.getConversationRecvMessageOpt=(e,n=o())=>this._invoker("getConversationRecvMessageOpt ",window.getConversationRecvMessageOpt,[n,JSON.stringify(e)]),this.setConversationRecvMessageOpt=(e,n=o())=>this._invoker("setConversationRecvMessageOpt ",window.setConversation,[n,e.conversationID,JSON.stringify({recvMsgOpt:e.opt})]),this.searchLocalMessages=(e,n=o())=>this._invoker("searchLocalMessages ",window.searchLocalMessages,[n,JSON.stringify(e)]),this.addFriend=(e,n=o())=>this._invoker("addFriend ",window.addFriend,[n,JSON.stringify(e)]),this.searchFriends=(e,n=o())=>this._invoker("searchFriends ",window.searchFriends,[n,JSON.stringify(e)]),this.getSpecifiedFriendsInfo=(e,n=o())=>this._invoker("getSpecifiedFriendsInfo",window.getSpecifiedFriendsInfo,[n,JSON.stringify(e.friendUserIDList),e.filterBlack]),this.getFriendApplicationListAsRecipient=(e={handleResults:[],offset:0,count:0},n=o())=>this._invoker("getFriendApplicationListAsRecipient ",window.getFriendApplicationListAsRecipient,[n,JSON.stringify(e)]),this.getFriendApplicationListAsApplicant=(e={offset:0,count:0},n=o())=>this._invoker("getFriendApplicationListAsApplicant ",window.getFriendApplicationListAsApplicant,[n,JSON.stringify(e)]),this.getFriendApplicationUnhandledCount=(e,n=o())=>this._invoker("getFriendApplicationUnhandledCount ",window.getFriendApplicationUnhandledCount,[n,JSON.stringify(e)]),this.getFriendList=(e=!1,n=o())=>this._invoker("getFriendList ",window.getFriendList,[n,e]),this.getFriendListPage=(e,n=o())=>{var a;return this._invoker("getFriendListPage ",window.getFriendListPage,[n,e.offset,e.count,(a=e.filterBlack)!==null&&a!==void 0?a:!1])},this.updateFriends=(e,n=o())=>this._invoker("updateFriends ",window.updateFriends,[n,JSON.stringify(e)]),this.setFriendRemark=(e,n=o())=>this._invoker("setFriendRemark ",window.updateFriends,[n,JSON.stringify({friendUserIDs:[e.toUserID],remark:e.remark})]),this.pinFriends=(e,n=o())=>this._invoker("pinFriends ",window.updateFriends,[n,JSON.stringify({friendUserIDs:e.toUserIDs,isPinned:e.isPinned})]),this.setFriendsEx=(e,n=o())=>this._invoker("setFriendsEx ",window.updateFriends,[n,JSON.stringify({friendUserIDs:e.toUserIDs,ex:e.ex}),e.ex]),this.checkFriend=(e,n=o())=>this._invoker("checkFriend",window.checkFriend,[n,JSON.stringify(e)]),this.acceptFriendApplication=(e,n=o())=>this._invoker("acceptFriendApplication",window.acceptFriendApplication,[n,JSON.stringify(e)]),this.refuseFriendApplication=(e,n=o())=>this._invoker("refuseFriendApplication ",window.refuseFriendApplication,[n,JSON.stringify(e)]),this.deleteFriend=(e,n=o())=>this._invoker("deleteFriend ",window.deleteFriend,[n,e]),this.addBlack=(e,n=o())=>{var a;return this._invoker("addBlack ",window.addBlack,[n,e.toUserID,(a=e.ex)!==null&&a!==void 0?a:""])},this.removeBlack=(e,n=o())=>this._invoker("removeBlack ",window.removeBlack,[n,e]),this.getBlackList=(e=o())=>this._invoker("getBlackList ",window.getBlackList,[e]),this.inviteUserToGroup=(e,n=o())=>this._invoker("inviteUserToGroup ",window.inviteUserToGroup,[n,e.groupID,e.reason,JSON.stringify(e.userIDList)]),this.kickGroupMember=(e,n=o())=>this._invoker("kickGroupMember ",window.kickGroupMember,[n,e.groupID,e.reason,JSON.stringify(e.userIDList)]),this.isJoinGroup=(e,n=o())=>this._invoker("isJoinGroup ",window.isJoinGroup,[n,e]),this.getSpecifiedGroupMembersInfo=(e,n=o())=>this._invoker("getSpecifiedGroupMembersInfo ",window.getSpecifiedGroupMembersInfo,[n,e.groupID,JSON.stringify(e.userIDList)]),this.getUsersInGroup=(e,n=o())=>this._invoker("getUsersInGroup ",window.getUsersInGroup,[n,e.groupID,JSON.stringify(e.userIDList)]),this.getGroupMemberListByJoinTimeFilter=(e,n=o())=>this._invoker("getGroupMemberListByJoinTimeFilter ",window.getGroupMemberListByJoinTimeFilter,[n,e.groupID,e.offset,e.count,e.joinTimeBegin,e.joinTimeEnd,JSON.stringify(e.filterUserIDList)]),this.searchGroupMembers=(e,n=o())=>this._invoker("searchGroupMembers ",window.searchGroupMembers,[n,JSON.stringify(e)]),this.setGroupApplyMemberFriend=(e,n=o())=>this._invoker("setGroupApplyMemberFriend ",window.setGroupInfo,[n,JSON.stringify({groupID:e.groupID,applyMemberFriend:e.rule})]),this.setGroupLookMemberInfo=(e,n=o())=>this._invoker("setGroupLookMemberInfo ",window.setGroupInfo,[n,JSON.stringify({groupID:e.groupID,lookMemberInfo:e.rule})]),this.getJoinedGroupList=(e=o())=>this._invoker("getJoinedGroupList ",window.getJoinedGroupList,[e]),this.getJoinedGroupListPage=(e,n=o())=>this._invoker("getJoinedGroupListPage ",window.getJoinedGroupListPage,[n,e.offset,e.count]),this.createGroup=(e,n=o())=>this._invoker("createGroup ",window.createGroup,[n,JSON.stringify(e)]),this.setGroupInfo=(e,n=o())=>this._invoker("setGroupInfo ",window.setGroupInfo,[n,JSON.stringify(e)]),this.setGroupMemberNickname=(e,n=o())=>this._invoker("setGroupMemberNickname ",window.setGroupMemberInfo,[n,JSON.stringify({groupID:e.groupID,userID:e.userID,nickname:e.groupMemberNickname})]),this.setGroupMemberInfo=(e,n=o())=>this._invoker("setGroupMemberInfo ",window.setGroupMemberInfo,[n,JSON.stringify(e)]),this.joinGroup=(e,n=o())=>{var a;return this._invoker("joinGroup ",window.joinGroup,[n,e.groupID,e.reqMsg,e.joinSource,(a=e.ex)!==null&&a!==void 0?a:""])},this.searchGroups=(e,n=o())=>this._invoker("searchGroups ",window.searchGroups,[n,JSON.stringify(e)]),this.quitGroup=(e,n=o())=>this._invoker("quitGroup ",window.quitGroup,[n,e]),this.dismissGroup=(e,n=o())=>this._invoker("dismissGroup ",window.dismissGroup,[n,e]),this.changeGroupMute=(e,n=o())=>this._invoker("changeGroupMute ",window.changeGroupMute,[n,e.groupID,e.isMute]),this.changeGroupMemberMute=(e,n=o())=>this._invoker("changeGroupMemberMute ",window.changeGroupMemberMute,[n,e.groupID,e.userID,e.mutedSeconds]),this.transferGroupOwner=(e,n=o())=>this._invoker("transferGroupOwner ",window.transferGroupOwner,[n,e.groupID,e.newOwnerUserID]),this.getGroupApplicationListAsApplicant=(e={groupID:[],handleResults:[],offset:0,count:0},n=o())=>this._invoker("getGroupApplicationListAsApplicant ",window.getGroupApplicationListAsApplicant,[n,JSON.stringify(e)]),this.getGroupApplicationListAsRecipient=(e={groupID:[],handleResults:[],offset:0,count:0},n=o())=>this._invoker("getGroupApplicationListAsRecipient ",window.getGroupApplicationListAsRecipient,[n,JSON.stringify(e)]),this.getGroupApplicationUnhandledCount=(e,n=o())=>this._invoker("getGroupApplicationUnhandledCount ",window.getGroupApplicationUnhandledCount,[n,JSON.stringify(e)]),this.acceptGroupApplication=(e,n=o())=>this._invoker("acceptGroupApplication ",window.acceptGroupApplication,[n,e.groupID,e.fromUserID,e.handleMsg]),this.refuseGroupApplication=(e,n=o())=>this._invoker("refuseGroupApplication ",window.refuseGroupApplication,[n,e.groupID,e.fromUserID,e.handleMsg]),this.resetConversationGroupAtType=(e,n=o())=>this._invoker("resetConversationGroupAtType ",window.setConversation,[n,e,JSON.stringify({groupAtType:fe.AtNormal})]),this.setGroupMemberRoleLevel=(e,n=o())=>this._invoker("setGroupMemberRoleLevel ",window.setGroupMemberInfo,[n,JSON.stringify({groupID:e.groupID,userID:e.userID,roleLevel:e.roleLevel})]),this.setGroupVerification=(e,n=o())=>this._invoker("setGroupVerification ",window.setGroupInfo,[n,JSON.stringify({groupID:e.groupID,needVerification:e.verification})]),this.getGroupMemberOwnerAndAdmin=(e,n=o())=>this._invoker("getGroupMemberOwnerAndAdmin ",window.getGroupMemberOwnerAndAdmin,[n,e]),this.setGlobalRecvMessageOpt=(e,n=o())=>this._invoker("setGlobalRecvMessageOpt ",window.setSelfInfo,[n,JSON.stringify({globalRecvMsgOpt:e})]),this.findMessageList=(e,n=o())=>this._invoker("findMessageList ",window.findMessageList,[n,JSON.stringify(e)]),this.uploadFile=(e,n=o())=>{var a;return e.uuid=`${e.uuid}/${(a=e.file)===null||a===void 0?void 0:a.name}`,window.fileMapSet(e.uuid,e.file),this._invoker("uploadFile ",window.uploadFile,[n,JSON.stringify({...e,filepath:"",cause:""})])},this.subscribeUsersStatus=(e,n=o())=>this._invoker("subscribeUsersStatus ",window.subscribeUsersStatus,[n,JSON.stringify(e)]),this.unsubscribeUsersStatus=(e,n=o())=>this._invoker("unsubscribeUsersStatus ",window.unsubscribeUsersStatus,[n,JSON.stringify(e)]),this.getUserStatus=(e=o())=>this._invoker("getUserStatus ",window.getUserStatus,[e]),this.getSubscribeUsersStatus=(e=o())=>this._invoker("getSubscribeUsersStatus ",window.getSubscribeUsersStatus,[e]),this.signalingInvite=(e,n=o())=>this._invoker("signalingInvite ",window.signalingInvite,[n,JSON.stringify(e)]),this.signalingInviteInGroup=(e,n=o())=>this._invoker("signalingInviteInGroup ",window.signalingInviteInGroup,[n,JSON.stringify(e)]),this.signalingAccept=(e,n=o())=>this._invoker("signalingAccept ",window.signalingAccept,[n,JSON.stringify(e)]),this.signalingReject=(e,n=o())=>this._invoker("signalingReject ",window.signalingReject,[n,JSON.stringify(e)]),this.signalingCancel=(e,n=o())=>this._invoker("signalingCancel ",window.signalingCancel,[n,JSON.stringify(e)]),this.signalingHungUp=(e,n=o())=>this._invoker("signalingHungUp ",window.signalingHungUp,[n,JSON.stringify(e)]),this.signalingGetRoomByGroupID=(e,n=o())=>this._invoker("signalingGetRoomByGroupID ",window.signalingGetRoomByGroupID,[n,e]),this.signalingGetTokenByRoomID=(e,n=o())=>this._invoker("signalingGetTokenByRoomID ",window.signalingGetTokenByRoomID,[n,e]),this.getSignalingInvitationInfoStartApp=(e=o())=>this._invoker("getSignalingInvitationInfoStartApp ",window.getSignalingInvitationInfoStartApp,[e]),this.signalingSendCustomSignal=(e,n=o())=>this._invoker("signalingSendCustomSignal ",window.signalingSendCustomSignal,[n,e.customInfo,e.roomID]),this.setConversationIsMsgDestruct=(e,n=o())=>this._invoker("setConversationIsMsgDestruct ",window.setConversation,[n,e.conversationID,JSON.stringify({isMsgDestruct:e.isMsgDestruct})]),this.setConversationMsgDestructTime=(e,n=o())=>this._invoker("setConversationMsgDestructTime ",window.setConversation,[n,e.conversationID,JSON.stringify({msgDestructTime:e.msgDestructTime})]),this.fileMapSet=(e,n)=>window.fileMapSet(e,n),Nt(d),this.isLogStandardOutput=d,this.wasmInitializedPromise=Ut(i),this.goExitPromise=Ft(),this.goExitPromise&&this.goExitPromise.then(()=>{this._logWrap("SDK => wasm exist")}).catch(e=>{this._logWrap("SDK => wasm with error ",e)}).finally(()=>{this.goExisted=!0})}_logWrap(...i){this.isLogStandardOutput&&console.info(...i)}_invoker(i,d,e,n){return new Promise(async(a,l)=>{this._logWrap(`%cSDK =>%c [OperationID:${e[0]}] (invoked by js) run ${i} with args ${JSON.stringify(e)}`,"font-size:14px; background:#7CAEFF; border-radius:4px; padding-inline:4px;","");let m={operationID:e[0],event:i.slice(0,1).toUpperCase()+i.slice(1).toLowerCase()};try{if(!Le()||Le().exited||this.goExisted)throw"wasm exist already, fail to run";let h=await d(...e);if(n&&(this._logWrap(`%cSDK =>%c [OperationID:${e[0]}] (invoked by js) run ${i} with response before processor ${JSON.stringify(h)}`,ge("#FFDC19"),""),h=n(h)),this.tryParse)try{h=JSON.parse(h)}catch{}m.data=h,a(m)}catch(h){this._logWrap(`%cSDK =>%c [OperationID:${e[0]}] (invoked by js) run ${i} with error ${JSON.stringify(h)}`,ge("#EE4245"),""),m={...m,...h},l(m)}})}exportDB(i=o()){return this._invoker("exportDB",window.exportDB,[i])}}let de;function _t(t){const{sqlWasmPath:i,coreWasmPath:d="/openIM.wasm",debug:e=!0}=t||{};return typeof window>"u"?{}:de||(de=new Vt(d,e),i&&window.setSqlWasmPath(i),de)}function jt(t,i){var d=atob(t);return d}function Jt(t,i,d){var e=jt(t),n=e.indexOf(`
`,10)+1,a=e.substring(n)+"",l=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(l)}function Kt(t,i,d){var e;return function(a){return e=e||Jt(t),new Worker(e,a)}}var Yt=Kt("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7bGV0IHQ9MzczNTkyODU1OTtjbGFzcyBle2NvbnN0cnVjdG9yKHQse2luaXRpYWxPZmZzZXQ6ZT00LHVzZUF0b21pY3M6aT0hMCxzdHJlYW06cz0hMCxkZWJ1ZzpyLG5hbWU6bn09e30pe3RoaXMuYnVmZmVyPXQsdGhpcy5hdG9taWNWaWV3PW5ldyBJbnQzMkFycmF5KHQpLHRoaXMub2Zmc2V0PWUsdGhpcy51c2VBdG9taWNzPWksdGhpcy5zdHJlYW09cyx0aGlzLmRlYnVnPXIsdGhpcy5uYW1lPW59bG9nKC4uLnQpe3RoaXMuZGVidWcmJmNvbnNvbGUubG9nKGBbcmVhZGVyOiAke3RoaXMubmFtZX1dYCwuLi50KX13YWl0V3JpdGUodCxlPW51bGwpe2lmKHRoaXMudXNlQXRvbWljcyl7Zm9yKHRoaXMubG9nKGB3YWl0aW5nIGZvciAke3R9YCk7MD09PUF0b21pY3MubG9hZCh0aGlzLmF0b21pY1ZpZXcsMCk7KXtpZihudWxsIT1lJiYidGltZWQtb3V0Ij09PUF0b21pY3Mud2FpdCh0aGlzLmF0b21pY1ZpZXcsMCwwLGUpKXRocm93IG5ldyBFcnJvcigidGltZW91dCIpO0F0b21pY3Mud2FpdCh0aGlzLmF0b21pY1ZpZXcsMCwwLDUwMCl9dGhpcy5sb2coYHJlc3VtZWQgZm9yICR7dH1gKX1lbHNlIGlmKDEhPT10aGlzLmF0b21pY1ZpZXdbMF0pdGhyb3cgbmV3IEVycm9yKCJgd2FpdFdyaXRlYCBleHBlY3RlZCBhcnJheSB0byBiZSByZWFkYWJsZSIpfWZsaXAoKXtpZih0aGlzLmxvZygiZmxpcCIpLHRoaXMudXNlQXRvbWljcyl7aWYoMSE9PUF0b21pY3MuY29tcGFyZUV4Y2hhbmdlKHRoaXMuYXRvbWljVmlldywwLDEsMCkpdGhyb3cgbmV3IEVycm9yKCJSZWFkIGRhdGEgb3V0IG9mIHN5bmMhIFRoaXMgaXMgZGlzYXN0cm91cyIpO0F0b21pY3Mubm90aWZ5KHRoaXMuYXRvbWljVmlldywwKX1lbHNlIHRoaXMuYXRvbWljVmlld1swXT0wO3RoaXMub2Zmc2V0PTR9ZG9uZSgpe3RoaXMud2FpdFdyaXRlKCJkb25lIik7bGV0IGU9bmV3IERhdGFWaWV3KHRoaXMuYnVmZmVyLHRoaXMub2Zmc2V0KS5nZXRVaW50MzIoMCk9PT10O3JldHVybiBlJiYodGhpcy5sb2coImRvbmUiKSx0aGlzLmZsaXAoKSksZX1wZWVrKHQpe3RoaXMucGVla09mZnNldD10aGlzLm9mZnNldDtsZXQgZT10KCk7cmV0dXJuIHRoaXMub2Zmc2V0PXRoaXMucGVla09mZnNldCx0aGlzLnBlZWtPZmZzZXQ9bnVsbCxlfXN0cmluZyh0KXt0aGlzLndhaXRXcml0ZSgic3RyaW5nIix0KTtsZXQgZT10aGlzLl9pbnQzMigpLGk9ZS8yLHM9bmV3IERhdGFWaWV3KHRoaXMuYnVmZmVyLHRoaXMub2Zmc2V0LGUpLHI9W107Zm9yKGxldCB0PTA7dDxpO3QrKylyLnB1c2gocy5nZXRVaW50MTYoMip0KSk7bGV0IG49U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLHIpO3JldHVybiB0aGlzLmxvZygic3RyaW5nIixuKSx0aGlzLm9mZnNldCs9ZSxudWxsPT10aGlzLnBlZWtPZmZzZXQmJnRoaXMuZmxpcCgpLG59X2ludDMyKCl7bGV0IHQ9bmV3IERhdGFWaWV3KHRoaXMuYnVmZmVyLHRoaXMub2Zmc2V0KS5nZXRJbnQzMigpO3JldHVybiB0aGlzLmxvZygiX2ludDMyIix0KSx0aGlzLm9mZnNldCs9NCx0fWludDMyKCl7dGhpcy53YWl0V3JpdGUoImludDMyIik7bGV0IHQ9dGhpcy5faW50MzIoKTtyZXR1cm4gdGhpcy5sb2coImludDMyIix0KSxudWxsPT10aGlzLnBlZWtPZmZzZXQmJnRoaXMuZmxpcCgpLHR9Ynl0ZXMoKXt0aGlzLndhaXRXcml0ZSgiYnl0ZXMiKTtsZXQgdD10aGlzLl9pbnQzMigpLGU9bmV3IEFycmF5QnVmZmVyKHQpO3JldHVybiBuZXcgVWludDhBcnJheShlKS5zZXQobmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXIsdGhpcy5vZmZzZXQsdCkpLHRoaXMubG9nKCJieXRlcyIsZSksdGhpcy5vZmZzZXQrPXQsbnVsbD09dGhpcy5wZWVrT2Zmc2V0JiZ0aGlzLmZsaXAoKSxlfX1jbGFzcyBpe2NvbnN0cnVjdG9yKHQse2luaXRpYWxPZmZzZXQ6ZT00LHVzZUF0b21pY3M6aT0hMCxzdHJlYW06cz0hMCxkZWJ1ZzpyLG5hbWU6bn09e30pe3RoaXMuYnVmZmVyPXQsdGhpcy5hdG9taWNWaWV3PW5ldyBJbnQzMkFycmF5KHQpLHRoaXMub2Zmc2V0PWUsdGhpcy51c2VBdG9taWNzPWksdGhpcy5zdHJlYW09cyx0aGlzLmRlYnVnPXIsdGhpcy5uYW1lPW4sdGhpcy51c2VBdG9taWNzP0F0b21pY3Muc3RvcmUodGhpcy5hdG9taWNWaWV3LDAsMCk6dGhpcy5hdG9taWNWaWV3WzBdPTB9bG9nKC4uLnQpe3RoaXMuZGVidWcmJmNvbnNvbGUubG9nKGBbd3JpdGVyOiAke3RoaXMubmFtZX1dYCwuLi50KX13YWl0UmVhZCh0KXtpZih0aGlzLnVzZUF0b21pY3Mpe2lmKHRoaXMubG9nKGB3YWl0aW5nIGZvciAke3R9YCksMCE9PUF0b21pY3MuY29tcGFyZUV4Y2hhbmdlKHRoaXMuYXRvbWljVmlldywwLDAsMSkpdGhyb3cgbmV3IEVycm9yKCJXcm90ZSBzb21ldGhpbmcgaW50byB1bndyaXRhYmxlIGJ1ZmZlciEgVGhpcyBpcyBkaXNhc3Ryb3VzIik7Zm9yKEF0b21pY3Mubm90aWZ5KHRoaXMuYXRvbWljVmlldywwKTsxPT09QXRvbWljcy5sb2FkKHRoaXMuYXRvbWljVmlldywwKTspQXRvbWljcy53YWl0KHRoaXMuYXRvbWljVmlldywwLDEsNTAwKTt0aGlzLmxvZyhgcmVzdW1lZCBmb3IgJHt0fWApfWVsc2UgdGhpcy5hdG9taWNWaWV3WzBdPTE7dGhpcy5vZmZzZXQ9NH1maW5hbGl6ZSgpe3RoaXMubG9nKCJmaW5hbGl6aW5nIiksbmV3IERhdGFWaWV3KHRoaXMuYnVmZmVyLHRoaXMub2Zmc2V0KS5zZXRVaW50MzIoMCx0KSx0aGlzLndhaXRSZWFkKCJmaW5hbGl6ZSIpfXN0cmluZyh0KXt0aGlzLmxvZygic3RyaW5nIix0KTtsZXQgZT0yKnQubGVuZ3RoO3RoaXMuX2ludDMyKGUpO2xldCBpPW5ldyBEYXRhVmlldyh0aGlzLmJ1ZmZlcix0aGlzLm9mZnNldCxlKTtmb3IobGV0IGU9MDtlPHQubGVuZ3RoO2UrKylpLnNldFVpbnQxNigyKmUsdC5jaGFyQ29kZUF0KGUpKTt0aGlzLm9mZnNldCs9ZSx0aGlzLndhaXRSZWFkKCJzdHJpbmciKX1faW50MzIodCl7bmV3IERhdGFWaWV3KHRoaXMuYnVmZmVyLHRoaXMub2Zmc2V0KS5zZXRJbnQzMigwLHQpLHRoaXMub2Zmc2V0Kz00fWludDMyKHQpe3RoaXMubG9nKCJpbnQzMiIsdCksdGhpcy5faW50MzIodCksdGhpcy53YWl0UmVhZCgiaW50MzIiKX1ieXRlcyh0KXt0aGlzLmxvZygiYnl0ZXMiLHQpO2xldCBlPXQuYnl0ZUxlbmd0aDt0aGlzLl9pbnQzMihlKSxuZXcgVWludDhBcnJheSh0aGlzLmJ1ZmZlcix0aGlzLm9mZnNldCkuc2V0KG5ldyBVaW50OEFycmF5KHQpKSx0aGlzLm9mZnNldCs9ZSx0aGlzLndhaXRSZWFkKCJieXRlcyIpfX1sZXQgcz0wLHI9MSxuPTIsbz00O2xldCBhPS9eKCg/IWNocm9tZXxhbmRyb2lkKS4pKnNhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksbD1uZXcgTWFwLGM9bmV3IE1hcDtmdW5jdGlvbiBoKHQsZSl7aWYoIXQpdGhyb3cgbmV3IEVycm9yKGUpfWNsYXNzIGZ7Y29uc3RydWN0b3IodCxlPSJyZWFkb25seSIpe3RoaXMuZGI9dCx0aGlzLnRyYW5zPXRoaXMuZGIudHJhbnNhY3Rpb24oWyJkYXRhIl0sZSksdGhpcy5zdG9yZT10aGlzLnRyYW5zLm9iamVjdFN0b3JlKCJkYXRhIiksdGhpcy5sb2NrVHlwZT0icmVhZG9ubHkiPT09ZT9yOm8sdGhpcy5jYWNoZWRGaXJzdEJsb2NrPW51bGwsdGhpcy5jdXJzb3I9bnVsbCx0aGlzLnByZXZSZWFkcz1udWxsfWFzeW5jIHByZWZldGNoRmlyc3RCbG9jayh0KXtsZXQgZT1hd2FpdCB0aGlzLmdldCgwKTtyZXR1cm4gdGhpcy5jYWNoZWRGaXJzdEJsb2NrPWUsZX1hc3luYyB3YWl0Q29tcGxldGUoKXtyZXR1cm4gbmV3IFByb21pc2UoKCh0LGUpPT57dGhpcy5jb21taXQoKSx0aGlzLmxvY2tUeXBlPT09bz8odGhpcy50cmFucy5vbmNvbXBsZXRlPWU9PnQoKSx0aGlzLnRyYW5zLm9uZXJyb3I9dD0+ZSh0KSk6YT90aGlzLnRyYW5zLm9uY29tcGxldGU9ZT0+dCgpOnQoKX0pKX1jb21taXQoKXt0aGlzLnRyYW5zLmNvbW1pdCYmdGhpcy50cmFucy5jb21taXQoKX1hc3luYyB1cGdyYWRlRXhjbHVzaXZlKCl7dGhpcy5jb21taXQoKSx0aGlzLnRyYW5zPXRoaXMuZGIudHJhbnNhY3Rpb24oWyJkYXRhIl0sInJlYWR3cml0ZSIpLHRoaXMuc3RvcmU9dGhpcy50cmFucy5vYmplY3RTdG9yZSgiZGF0YSIpLHRoaXMubG9ja1R5cGU9bztsZXQgdD10aGlzLmNhY2hlZEZpcnN0QmxvY2s7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7aWYobnVsbCE9dCYmbnVsbCE9ZSl7bGV0IGk9bmV3IFVpbnQ4QXJyYXkodCkscz1uZXcgVWludDhBcnJheShlKTtmb3IobGV0IHQ9MjQ7dDw0MDt0KyspaWYoaVt0XSE9PXNbdF0pcmV0dXJuITE7cmV0dXJuITB9cmV0dXJuIG51bGw9PXQmJm51bGw9PWV9KGF3YWl0IHRoaXMucHJlZmV0Y2hGaXJzdEJsb2NrKDUwMCksdCl9ZG93bmdyYWRlU2hhcmVkKCl7dGhpcy5jb21taXQoKSx0aGlzLnRyYW5zPXRoaXMuZGIudHJhbnNhY3Rpb24oWyJkYXRhIl0sInJlYWRvbmx5IiksdGhpcy5zdG9yZT10aGlzLnRyYW5zLm9iamVjdFN0b3JlKCJkYXRhIiksdGhpcy5sb2NrVHlwZT1yfWFzeW5jIGdldCh0KXtyZXR1cm4gbmV3IFByb21pc2UoKChlLGkpPT57bGV0IHM9dGhpcy5zdG9yZS5nZXQodCk7cy5vbnN1Y2Nlc3M9dD0+e2Uocy5yZXN1bHQpfSxzLm9uZXJyb3I9dD0+aSh0KX0pKX1nZXRSZWFkRGlyZWN0aW9uKCl7bGV0IHQ9dGhpcy5wcmV2UmVhZHM7aWYodCl7aWYodFswXTx0WzFdJiZ0WzFdPHRbMl0mJnRbMl0tdFswXTwxMClyZXR1cm4ibmV4dCI7aWYodFswXT50WzFdJiZ0WzFdPnRbMl0mJnRbMF0tdFsyXTwxMClyZXR1cm4icHJldiJ9cmV0dXJuIG51bGx9cmVhZCh0KXtsZXQgZT0oKT0+bmV3IFByb21pc2UoKCh0LGUpPT57aWYobnVsbCE9dGhpcy5jdXJzb3JQcm9taXNlKXRocm93IG5ldyBFcnJvcigid2FpdEN1cnNvcigpIGNhbGxlZCBidXQgc29tZXRoaW5nIGVsc2UgaXMgYWxyZWFkeSB3YWl0aW5nIik7dGhpcy5jdXJzb3JQcm9taXNlPXtyZXNvbHZlOnQscmVqZWN0OmV9fSkpO2lmKHRoaXMuY3Vyc29yKXtsZXQgaT10aGlzLmN1cnNvcjtyZXR1cm4ibmV4dCI9PT1pLmRpcmVjdGlvbiYmdD5pLmtleSYmdDxpLmtleSsxMDA/KGkuYWR2YW5jZSh0LWkua2V5KSxlKCkpOiJwcmV2Ij09PWkuZGlyZWN0aW9uJiZ0PGkua2V5JiZ0Pmkua2V5LTEwMD8oaS5hZHZhbmNlKGkua2V5LXQpLGUoKSk6KHRoaXMuY3Vyc29yPW51bGwsdGhpcy5yZWFkKHQpKX17bGV0IGk9dGhpcy5nZXRSZWFkRGlyZWN0aW9uKCk7aWYoaSl7bGV0IHM7dGhpcy5wcmV2UmVhZHM9bnVsbCxzPSJwcmV2Ij09PWk/SURCS2V5UmFuZ2UudXBwZXJCb3VuZCh0KTpJREJLZXlSYW5nZS5sb3dlckJvdW5kKHQpO2xldCByPXRoaXMuc3RvcmUub3BlbkN1cnNvcihzLGkpO3JldHVybiByLm9uc3VjY2Vzcz10PT57bGV0IGU9dC50YXJnZXQucmVzdWx0O2lmKHRoaXMuY3Vyc29yPWUsbnVsbD09dGhpcy5jdXJzb3JQcm9taXNlKXRocm93IG5ldyBFcnJvcigiR290IGRhdGEgZnJvbSBjdXJzb3IgYnV0IG5vdGhpbmcgaXMgd2FpdGluZyBpdCIpO3RoaXMuY3Vyc29yUHJvbWlzZS5yZXNvbHZlKGU/ZS52YWx1ZTpudWxsKSx0aGlzLmN1cnNvclByb21pc2U9bnVsbH0sci5vbmVycm9yPXQ9PntpZihjb25zb2xlLmxvZygiQ3Vyc29yIGZhaWx1cmU6Iix0KSxudWxsPT10aGlzLmN1cnNvclByb21pc2UpdGhyb3cgbmV3IEVycm9yKCJHb3QgZGF0YSBmcm9tIGN1cnNvciBidXQgbm90aGluZyBpcyB3YWl0aW5nIGl0Iik7dGhpcy5jdXJzb3JQcm9taXNlLnJlamVjdCh0KSx0aGlzLmN1cnNvclByb21pc2U9bnVsbH0sZSgpfXJldHVybiBudWxsPT10aGlzLnByZXZSZWFkcyYmKHRoaXMucHJldlJlYWRzPVswLDAsMF0pLHRoaXMucHJldlJlYWRzLnB1c2godCksdGhpcy5wcmV2UmVhZHMuc2hpZnQoKSx0aGlzLmdldCh0KX19YXN5bmMgc2V0KHQpe3JldHVybiB0aGlzLnByZXZSZWFkcz1udWxsLG5ldyBQcm9taXNlKCgoZSxpKT0+e2xldCBzPXRoaXMuc3RvcmUucHV0KHQudmFsdWUsdC5rZXkpO3Mub25zdWNjZXNzPXQ9PmUocy5yZXN1bHQpLHMub25lcnJvcj10PT5pKHQpfSkpfWFzeW5jIGJ1bGtTZXQodCl7dGhpcy5wcmV2UmVhZHM9bnVsbDtmb3IobGV0IGUgb2YgdCl0aGlzLnN0b3JlLnB1dChlLnZhbHVlLGUua2V5KX19YXN5bmMgZnVuY3Rpb24gdSh0KXtyZXR1cm4gbmV3IFByb21pc2UoKChlLGkpPT57aWYobC5nZXQodCkpcmV0dXJuIHZvaWQgZShsLmdldCh0KSk7bGV0IHM9Z2xvYmFsVGhpcy5pbmRleGVkREIub3Blbih0LDIpO3Mub25zdWNjZXNzPWk9PntsZXQgcz1pLnRhcmdldC5yZXN1bHQ7cy5vbnZlcnNpb25jaGFuZ2U9KCk9Pntjb25zb2xlLmxvZygiY2xvc2luZyBiZWNhdXNlIHZlcnNpb24gY2hhbmdlZCIpLHMuY2xvc2UoKSxsLmRlbGV0ZSh0KX0scy5vbmNsb3NlPSgpPT57bC5kZWxldGUodCl9LGwuc2V0KHQscyksZShzKX0scy5vbnVwZ3JhZGVuZWVkZWQ9dD0+e2xldCBlPXQudGFyZ2V0LnJlc3VsdDtlLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMoImRhdGEiKXx8ZS5jcmVhdGVPYmplY3RTdG9yZSgiZGF0YSIpfSxzLm9uYmxvY2tlZD10PT5jb25zb2xlLmxvZygiYmxvY2tlZCIsdCkscy5vbmVycm9yPXMub25hYm9ydD10PT5pKHQudGFyZ2V0LmVycm9yKX0pKX1hc3luYyBmdW5jdGlvbiB3KHQsZSxpKXtsZXQgcz1jLmdldCh0KTtpZihzKXtpZigicmVhZHdyaXRlIj09PWUmJnMubG9ja1R5cGU9PT1yKXRocm93IG5ldyBFcnJvcigiQXR0ZW1wdGVkIHdyaXRlIGJ1dCBvbmx5IGhhcyBTSEFSRUQgbG9jayIpO3JldHVybiBpKHMpfXM9bmV3IGYoYXdhaXQgdSh0KSxlKSxhd2FpdCBpKHMpLGF3YWl0IHMud2FpdENvbXBsZXRlKCl9YXN5bmMgZnVuY3Rpb24gZCh0LGUsaSl7bGV0IG49ZnVuY3Rpb24odCl7cmV0dXJuIGMuZ2V0KHQpfShlKTtpZihpPT09cil7aWYobnVsbD09bil0aHJvdyBuZXcgRXJyb3IoIlVubG9jayBlcnJvciAoU0hBUkVEKTogbm8gdHJhbnNhY3Rpb24gcnVubmluZyIpO24ubG9ja1R5cGU9PT1vJiZuLmRvd25ncmFkZVNoYXJlZCgpfWVsc2UgaT09PXMmJm4mJihhd2FpdCBuLndhaXRDb21wbGV0ZSgpLGMuZGVsZXRlKGUpKTt0LmludDMyKDApLHQuZmluYWxpemUoKX1hc3luYyBmdW5jdGlvbiBnKHQsZSl7bGV0IGk9dC5zdHJpbmcoKTtzd2l0Y2goaSl7Y2FzZSJwcm9maWxlLXN0YXJ0Ijp0LmRvbmUoKSxlLmludDMyKDApLGUuZmluYWxpemUoKSxnKHQsZSk7YnJlYWs7Y2FzZSJwcm9maWxlLXN0b3AiOnQuZG9uZSgpLGF3YWl0IG5ldyBQcm9taXNlKCh0PT5zZXRUaW1lb3V0KHQsMWUzKSkpLGUuaW50MzIoMCksZS5maW5hbGl6ZSgpLGcodCxlKTticmVhaztjYXNlIndyaXRlQmxvY2tzIjp7bGV0IGk9dC5zdHJpbmcoKSxzPVtdO2Zvcig7IXQuZG9uZSgpOyl7bGV0IGU9dC5pbnQzMigpLGk9dC5ieXRlcygpO3MucHVzaCh7cG9zOmUsZGF0YTppfSl9YXdhaXQgYXN5bmMgZnVuY3Rpb24odCxlLGkpe3JldHVybiB3KGUsInJlYWR3cml0ZSIsKGFzeW5jIGU9Pnthd2FpdCBlLmJ1bGtTZXQoaS5tYXAoKHQ9Pih7a2V5OnQucG9zLHZhbHVlOnQuZGF0YX0pKSkpLHQuaW50MzIoMCksdC5maW5hbGl6ZSgpfSkpfShlLGkscyksZyh0LGUpO2JyZWFrfWNhc2UicmVhZEJsb2NrIjp7bGV0IGk9dC5zdHJpbmcoKSxzPXQuaW50MzIoKTt0LmRvbmUoKSxhd2FpdCBhc3luYyBmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHcoZSwicmVhZG9ubHkiLChhc3luYyBlPT57bGV0IHM9YXdhaXQgZS5yZWFkKGkpO251bGw9PXM/dC5ieXRlcyhuZXcgQXJyYXlCdWZmZXIoMCkpOnQuYnl0ZXMocyksdC5maW5hbGl6ZSgpfSkpfShlLGkscyksZyh0LGUpO2JyZWFrfWNhc2UicmVhZE1ldGEiOntsZXQgaT10LnN0cmluZygpO3QuZG9uZSgpLGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHcoZSwicmVhZG9ubHkiLChhc3luYyBpPT57dHJ5e2NvbnNvbGUubG9nKCJSZWFkaW5nIG1ldGEuLi4iKTtsZXQgcz1hd2FpdCBpLmdldCgtMSk7aWYoY29uc29sZS5sb2coYEdvdCBtZXRhIGZvciAke2V9OmAscyksbnVsbD09cyl0LmludDMyKC0xKSx0LmludDMyKDQwOTYpLHQuZmluYWxpemUoKTtlbHNle2xldCBlPWF3YWl0IGkuZ2V0KDApLHI9NDA5NjtlJiYocj0yNTYqbmV3IFVpbnQxNkFycmF5KGUpWzhdKSx0LmludDMyKHMuc2l6ZSksdC5pbnQzMihyKSx0LmZpbmFsaXplKCl9fWNhdGNoKGUpe2NvbnNvbGUubG9nKGUpLHQuaW50MzIoLTEpLHQuaW50MzIoLTEpLHQuZmluYWxpemUoKX19KSl9KGUsaSksZyh0LGUpO2JyZWFrfWNhc2Uid3JpdGVNZXRhIjp7bGV0IGk9dC5zdHJpbmcoKSxzPXQuaW50MzIoKTt0LmRvbmUoKSxhd2FpdCBhc3luYyBmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHcoZSwicmVhZHdyaXRlIiwoYXN5bmMgZT0+e3RyeXthd2FpdCBlLnNldCh7a2V5Oi0xLHZhbHVlOml9KSx0LmludDMyKDApLHQuZmluYWxpemUoKX1jYXRjaChlKXtjb25zb2xlLmxvZyhlKSx0LmludDMyKC0xKSx0LmZpbmFsaXplKCl9fSkpfShlLGkse3NpemU6c30pLGcodCxlKTticmVha31jYXNlImNsb3NlRmlsZSI6e2xldCBpPXQuc3RyaW5nKCk7dC5kb25lKCksZS5pbnQzMigwKSxlLmZpbmFsaXplKCksZnVuY3Rpb24odCl7bGV0IGU9bC5nZXQodCk7ZSYmKGUuY2xvc2UoKSxsLmRlbGV0ZSh0KSl9KGkpLHNlbGYuY2xvc2UoKTticmVha31jYXNlImxvY2tGaWxlIjp7bGV0IGk9dC5zdHJpbmcoKSxzPXQuaW50MzIoKTt0LmRvbmUoKSxhd2FpdCBhc3luYyBmdW5jdGlvbih0LGUsaSl7bGV0IHM9Yy5nZXQoZSk7aWYocylpZihpPnMubG9ja1R5cGUpe2gocy5sb2NrVHlwZT09PXIsYFVwcmFkaW5nIGxvY2sgdHlwZSBmcm9tICR7cy5sb2NrVHlwZX0gaXMgaW52YWxpZGApLGgoaT09PW58fGk9PT1vLGBVcGdyYWRpbmcgbG9jayB0eXBlIHRvICR7aX0gaXMgaW52YWxpZGApO2xldCBlPWF3YWl0IHMudXBncmFkZUV4Y2x1c2l2ZSgpO3QuaW50MzIoZT8wOi0xKSx0LmZpbmFsaXplKCl9ZWxzZSBoKHMubG9ja1R5cGU9PT1pLGBEb3duZ3JhZGluZyBsb2NrIHRvICR7aX0gaXMgaW52YWxpZGApLHQuaW50MzIoMCksdC5maW5hbGl6ZSgpO2Vsc2V7aChpPT09cixgTmV3IGxvY2tzIG11c3Qgc3RhcnQgYXMgU0hBUkVEIGluc3RlYWQgb2YgJHtpfWApO2xldCBzPW5ldyBmKGF3YWl0IHUoZSkpO2F3YWl0IHMucHJlZmV0Y2hGaXJzdEJsb2NrKDUwMCksYy5zZXQoZSxzKSx0LmludDMyKDApLHQuZmluYWxpemUoKX19KGUsaSxzKSxnKHQsZSk7YnJlYWt9Y2FzZSJ1bmxvY2tGaWxlIjp7bGV0IGk9dC5zdHJpbmcoKSxzPXQuaW50MzIoKTt0LmRvbmUoKSxhd2FpdCBkKGUsaSxzKSxnKHQsZSk7YnJlYWt9ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gbWV0aG9kOiAiK2kpfX1zZWxmLm9ubWVzc2FnZT10PT57c3dpdGNoKHQuZGF0YS50eXBlKXtjYXNlImluaXQiOntsZXRbcyxyXT10LmRhdGEuYnVmZmVycztnKG5ldyBlKHMse25hbWU6ImFyZ3MiLGRlYnVnOiExfSksbmV3IGkocix7bmFtZToicmVzdWx0cyIsZGVidWc6ITF9KSk7YnJlYWt9fX19KCk7Cgo="),zt=Object.freeze({__proto__:null,default:Yt});function Ht({onBack:t,OpenIM:i,groupInfo:d,conversation:e}){const[n,a]=u.useState(""),[l,m]=u.useState(!1),[h,G]=u.useState(!0),w=u.useRef(null),R=u.useRef(!1),[O,X]=u.useState([]),[N,C]=u.useState(!1),[W,g]=u.useState(!0),b=u.useRef(0),[F,U]=u.useState(!1);u.useRef(null);const[$,A]=u.useState(0),le=u.useRef(null),ee=u.useRef(!0),Se=({message:c})=>{var M;const v=c.sendID===localStorage.getItem("ACCESS_USER_ID"),y=new Date(c.sendTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return r.jsxs("div",{className:`flex items-center p-1 ${v?"flex-row-reverse":""}`,children:[r.jsx(ye,{className:"w-8 h-8 rounded-full mx-1 border-2 border-white",children:r.jsx(Ge,{children:(M=c.senderNickname)==null?void 0:M.slice(0,1)})}),r.jsxs("div",{className:`flex flex-col ${v?"items-end":"items-start"}`,children:[r.jsxs("div",{className:"mb-1 max-w-[240px] truncate text-xs text-gray-500",children:[y," ",c.senderNickname]}),r.jsx("div",{className:`p-3 rounded-lg ${v?"bg-blue-100":"bg-gray-100"}`,children:_(c)})]})]})},_=c=>{var y,M,J,B,K,Y,re,oe,Q,p,f,x,I,Z,H;const v=c==null?void 0:c.contentType;switch(v){case 101:return(y=c==null?void 0:c.textElem)==null?void 0:y.content;case 102:return r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{children:"[图片]"}),((J=(M=c==null?void 0:c.pictureElem)==null?void 0:M.sourcePicture)==null?void 0:J.url)&&r.jsx("img",{src:c.pictureElem.sourcePicture.url,alt:"图片",className:"max-w-[200px] max-h-[200px] mt-2 rounded"})]});case 105:return r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"mr-2",children:"📄"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:((B=c==null?void 0:c.fileElem)==null?void 0:B.fileName)||"文件"}),r.jsx("div",{className:"text-xs",children:ue((K=c==null?void 0:c.fileElem)==null?void 0:K.fileSize)})]})]});case 106:return r.jsxs("div",{children:[r.jsxs("span",{className:"text-blue-500",children:["@",(re=(Y=c==null?void 0:c.atTextElem)==null?void 0:Y.atUserInfo)==null?void 0:re.atUserID," "]}),(oe=c==null?void 0:c.atTextElem)==null?void 0:oe.text]});case 110:return(Q=c==null?void 0:c.textElem)==null?void 0:Q.content;case 114:return r.jsxs("div",{className:"border-l-2 border-gray-300 pl-2",children:[r.jsxs("div",{className:"text-xs text-gray-500",children:["引用: ",(f=(p=c==null?void 0:c.quoteElem)==null?void 0:p.quoteMessage)==null?void 0:f.senderNickname]}),r.jsx("div",{children:(I=(x=c==null?void 0:c.quoteElem)==null?void 0:x.quoteMessage)==null?void 0:I.content}),r.jsx("div",{children:(Z=c==null?void 0:c.quoteElem)==null?void 0:Z.text})]});case 115:return r.jsx("div",{children:r.jsx("span",{className:"text-2xl",children:((H=c==null?void 0:c.faceElem)==null?void 0:H.index)||"😊"})});case 1201:case 1501:case 1502:case 1504:case 1507:case 1508:case 1509:case 1510:case 1511:case 1512:case 1513:case 1514:case 1515:case 1519:case 1520:case 2101:return r.jsx("div",{className:"italic text-gray-500 text-center",children:te(c)});default:return`[暂不支持的消息类型: ${v}]`}},ue=c=>c?c<1024?`${c} B`:c<1024*1024?`${(c/1024).toFixed(1)} KB`:`${(c/(1024*1024)).toFixed(1)} MB`:"",te=c=>{switch(c==null?void 0:c.contentType){case 1201:return"好友已添加";case 1501:return"群组已创建";case 1502:return"群组信息已更新";case 1504:return"成员已退出群组";case 1507:return"群主已转移";case 1508:return"成员已被踢出";case 1509:return"成员已被邀请";case 1510:return"新成员加入";case 1511:return"群组已解散";case 1512:return"群成员已被禁言";case 1513:return"群成员禁言已取消";case 1514:return"群组已被禁言";case 1515:return"群组禁言已取消";case 1519:return"群公告已更新";case 1520:return"群名称已更新";case 2101:return"消息已被撤回";default:return"[系统通知]"}},j=()=>{i.on(ce.OnRecvNewMessages,({data:c})=>{console.log("收到新消息:",c);const v=c.filter(y=>y.groupID===(e==null?void 0:e.groupID));v.length>0&&(X(y=>[...y,...v]),ee.current?setTimeout(()=>{E()},100):A(y=>y+v.length))})},ne=async(c=!1)=>{var v;if(!(c&&(!W||h||N))){C(c),G(!0);try{const y=c&&O.length>0?O[0].clientMsgID:"",M={conversationID:e==null?void 0:e.conversationID,count:20,startClientMsgID:y,viewType:ve.History};c&&w.current&&(b.current=w.current.scrollTop);const J=await i.getAdvancedHistoryMessageList(M);if(console.log("历史消息",J),(v=J.data)!=null&&v.messageList){const B=J.data.messageList;B.length<20&&g(!1),X(c?K=>[...B,...K]:B),setTimeout(()=>{if(w.current)if(c){const K=B.reduce(Y=>Y+80,0);w.current.scrollTop=b.current+K}else w.current.scrollTop=w.current.scrollHeight},10)}else console.log("未获取到历史消息"),g(!1)}catch(y){console.error("获取历史消息失败:",y),g(!1)}finally{G(!1),C(!1)}}};u.useEffect(()=>{if(console.log("conversation:",e),e!=null&&e.conversationID&&!R.current)return R.current=!0,ne(),j(),()=>{i.off(ce.OnRecvNewMessages)}},[e]);const se=()=>{if(!w.current)return;const{scrollTop:c,scrollHeight:v,clientHeight:y}=w.current,M=v-c-y<=50;ee.current=M,M&&A(0)};u.useEffect(()=>{let c=null;const v=()=>{se(),!(!w.current||h||N||!W)&&(c&&clearTimeout(c),c=setTimeout(()=>{w.current.scrollTop<50&&ne(!0)},200))};return w.current&&(w.current.addEventListener("scroll",v),se()),()=>{c&&clearTimeout(c),w.current&&w.current.removeEventListener("scroll",v)}},[h,N,W]);const E=()=>{w.current&&(w.current.scrollTop=w.current.scrollHeight,A(0),ee.current=!0)},ie=async()=>{if(n.trim()){U(!0);try{const{data:c}=await i.createTextMessage(n),v={recvID:"",groupID:e.groupID,message:c};await i.sendMessage(v).then(({data:y})=>{console.log("消息发送成功:",y),X(M=>[...M,y]),setTimeout(()=>{E()},100)}).catch(({errCode:y,errMsg:M})=>{console.log("消息发送失败:"),console.log(y,M)}),a("")}catch(c){console.error("发送消息失败:",c)}finally{U(!1)}}};return r.jsxs("div",{className:"flex flex-col h-screen bg-gray-50 relative",children:[$>0&&r.jsxs("button",{ref:le,onClick:E,className:"absolute bottom-20 right-4 z-10 px-3 py-1 bg-blue-500 text-white rounded-full text-sm shadow-md animate-bounce",children:["有",$,"条新消息 ↓"]}),r.jsx("div",{className:"flex items-center justify-between p-4 bg-white border-b border-gray-200",children:r.jsxs("button",{onClick:t,className:"flex items-center",children:[r.jsx($e,{className:"h-6 w-6 text-gray-700 mr-2"}),r.jsx("div",{className:"flex flex-col",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("span",{className:"font-medium truncate max-w-[120px]",children:e==null?void 0:e.showName}),r.jsxs("span",{className:"text-gray-500 ml-1",children:["(",d==null?void 0:d.memberCount,")"]})]})})]})}),r.jsx("div",{ref:w,className:"flex-1 overflow-y-auto bg-gray-100 p-2",children:h?r.jsx("div",{className:"flex items-center justify-center h-full",children:r.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}):r.jsx("div",{className:"space-y-3",children:O.map(c=>r.jsx(Se,{message:c},c.clientMsgID))})}),l&&r.jsx("div",{className:"bg-white p-3 border-t border-gray-200",children:r.jsx("div",{className:"grid grid-cols-4 gap-3",children:["图片"].map(c=>r.jsxs("button",{className:"flex flex-col items-center p-2 hover:bg-gray-100 rounded",children:[r.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full mb-1 flex items-center justify-center",children:r.jsx(it,{className:"h-5 w-5 text-gray-600"})}),r.jsx("span",{className:"text-xs",children:c})]},c))})}),r.jsx("div",{className:"bg-gray-100 p-3 border-t border-gray-200 relative",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-grow bg-white rounded-lg border border-gray-300",children:r.jsx("textarea",{value:n,onChange:c=>a(c.target.value),onKeyDown:c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),ie())},placeholder:"请输入消息...",className:"w-full p-2 text-sm min-h-[40px] max-h-[120px] resize-none outline-none",rows:1})}),n?r.jsx("button",{onClick:ie,disabled:F,className:"ml-2 p-2 bg-blue-500 rounded-full text-white disabled:opacity-50",children:r.jsx(Ie,{className:"h-5 w-5"})}):r.jsx("button",{onClick:()=>m(!l),className:"ml-2 p-2 bg-white rounded-full border border-gray-300",children:r.jsx(Ie,{className:"h-5 w-5"})})]})})]})}const Pt=t=>at("/admin-api/app/addressbook/addressbookList",t),Tt=t=>ot("/admin-api/openIM/getUserToken",t),D={token:localStorage.getItem("openim_token")||"",expireTime:localStorage.getItem("openim_token_expire")?parseInt(localStorage.getItem("openim_token_expire")):0,isLoggedIn:!1};function Et({setShowBottomNavGlobal:t}){var Q;const i=u.useRef(!1),[d,e]=u.useState([]),[n,a]=u.useState([]),[l,m]=u.useState(null),[h,G]=u.useState(""),[w,R]=u.useState(!0),[O,X]=u.useState(null),[N,C]=u.useState(""),[W,g]=u.useState(!1),[b,F]=u.useState([]),[U,$]=u.useState({}),[A,le]=u.useState({}),[ee,Se]=u.useState(0),_=u.useRef(null),[ue,te]=u.useState(!1),[j,ne]=u.useState({nickname:"",email:"",mobile:"",telephoneCode:"",avatar:"",deptNames:[],userPosition:[],certificateQualificationDOList:[],companyName:"",completeness:"0%",roles:[]}),se=()=>{_.current=_t({coreWasmPath:"/assets/openIM.wasm",sqlWasmPath:"/assets/sql-wasm.wasm",debug:!0})},E=async()=>{try{const p=await rt();ne(p)}catch(p){console.error("获取用户信息失败:",p)}},ie=async()=>{R(!0);const p=localStorage.getItem("projectId");Pt({projectId:p}).then(f=>{const x=f.map(I=>({...I,contactDepartment:I.contactDepartment||"",departments:I.contactDepartment?I.contactDepartment.split(",").map(Z=>Z.trim()).filter(Z=>Z!==""):[]}));e(x),a(x)}).catch(f=>{X(`加载数据失败: ${f instanceof Error?f.message:String(f)}`)}).finally(()=>{R(!1)})};u.useEffect(()=>{i.current||(i.current=!0,console.log("执行初始数据获取"),se(),E(),ie(),c())},[]);const c=async()=>{var f;const p=Date.now();if(D.token&&D.expireTime>p){C(D.token),v();return}try{const x=localStorage.getItem("ACCESS_USER_ID"),I=await Tt({platformID:2,userID:x});if((f=I==null?void 0:I.data)!=null&&f.token){const Z=I.data.token,H=I.data.expireTimeSeconds*1e3||24*60*60*1e3,xe=Date.now()+H;localStorage.setItem("openim_token",Z),localStorage.setItem("openim_token_expire",xe.toString()),D.token=Z,D.expireTime=xe,C(Z),v()}}catch(x){console.error("获取用户token失败:",x)}},v=()=>{window.Go&&_.current?g(!0):setTimeout(v,100)};u.useEffect(()=>{const p=Date.now();if(N&&D&&D.expireTime&&D.expireTime<=p){console.log("Token已过期，重新获取..."),c();return}N&&W&&!D.isLoggedIn?y():N&&W&&D.isLoggedIn&&M()},[N,W]);const y=async()=>{try{const p={userID:localStorage.getItem("ACCESS_USER_ID"),token:N,platformID:2,wsAddr:"wss://ly-im.ruioutech.com:10001",apiAddr:"https://ly-im.ruioutech.com:10002"};await _.current.login(p).then(()=>{D.isLoggedIn=!0,M()}).catch(({errCode:f,errMsg:x})=>{f===10102?(D.isLoggedIn=!0,M()):console.error("登录失败:",f,x)})}catch(p){console.error("登录错误:",p)}},M=async()=>{try{R(!0),console.log("获取groupList.."),await _.current.getJoinedGroupListPage({offset:0,count:1e3}).then(({data:p})=>{console.log("获取加入的群聊成功",p),$(p[0]),J(p[0].groupID)}).catch(({errCode:p,errMsg:f})=>{console.error(p,f)})}catch(p){console.error("获取群组列表失败:",p)}finally{R(!1)}},J=async p=>{let f;try{f=(await _.current.getOneConversation({sourceID:p,sessionType:3})).data,console.log("获取群聊conversation信息",f),le(f)}catch(x){console.log("获取群聊conversation信息失败",x)}};u.useEffect(()=>{if(!h.trim())a(d);else{const p=d.filter(f=>{var x,I,Z;return f.name.toLowerCase().includes(h.toLowerCase())||((x=f.position)==null?void 0:x.toLowerCase().includes(h.toLowerCase()))||((I=f.departments)==null?void 0:I.some(H=>H.toLowerCase().includes(h.toLowerCase())))||((Z=f.company)==null?void 0:Z.toLowerCase().includes(h.toLowerCase()))});a(p)}},[h,d]);const B=async()=>{A?(te(!0),t(!1)):st({variant:"destructive",title:"暂未获取到群数据",className:"toast-center",duration:2e3})},K=()=>{te(!1),t(!0)},Y=p=>{p&&typeof window<"u"&&(window.location.href=`tel:${p}`)},re=()=>{m(null)},oe=()=>{G("")};return l?r.jsx(pt,{contact:l,onBack:re,onMakeCall:Y}):ue?r.jsx(Ht,{onBack:K,OpenIM:_.current,groupInfo:U,conversation:A}):r.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[r.jsxs("div",{className:"",children:[r.jsxs("div",{className:"flex items-center justify-between p-4",children:[r.jsx("h1",{className:"text-lg font-bold text-black",children:"通讯录"}),r.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 border-1 border-white flex items-center justify-center overflow-hidden",children:r.jsxs(ye,{className:"w-full h-full object-cover",children:[r.jsx(Qe,{src:(j==null?void 0:j.avatar)||qe,alt:"头像"}),r.jsx(Ge,{children:(Q=j==null?void 0:j.nickname)==null?void 0:Q.slice(0,1)})]})})]}),r.jsx("div",{className:"px-4 pb-4",children:r.jsxs("div",{className:"relative ",children:[r.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2",children:r.jsx(dt,{className:"h-4 w-4 text-gray-400"})}),r.jsx("input",{type:"text",placeholder:"搜索",className:"w-full pl-9 pr-9 py-2 bg-gray-100 rounded-lg border-0 text-sm bg-white",value:h,onChange:p=>G(p.target.value)}),h&&r.jsx("button",{className:"absolute right-3 top-1/2 -translate-y-1/2",onClick:oe,children:r.jsx(nt,{className:"h-4 w-4 text-gray-400"})})]})})]}),r.jsx("div",{className:"cursor-pointer bg-gray-50",children:r.jsxs("div",{className:"flex items-center flex-1 bg-white m-2 p-2 rounded-2xl",onClick:B,children:[r.jsx("div",{className:"w-12 h-12 bg-[#eff3fd] rounded-full flex items-center justify-center mr-3 overflow-hidden flex-shrink-0",children:r.jsxs("svg",{className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4302",width:"24",height:"24",children:[r.jsx("path",{d:"M120.9 907.5h617.4c0-171.2-93.4-316.5-223.8-371.6 81-48.4 129.9-144.9 103.6-251-19.7-79.5-84.7-143.6-164.5-162.2-148.5-34.6-280.4 77.1-280.4 219.7 0 82.5 44.7 154 110.8 193.5C170 584.1 84.3 701.3 64.5 844.4c-4.6 33.5 22.6 63.1 56.4 63.1zM306 588l2.2-0.9c9.9-4.2 18.7-11.2 25.1-20.8 6.4-9.6 9.4-20.5 9.4-31.2v2.3c0-9.5-2.4-19.1-7.4-27.9-5-8.8-12-15.8-20.2-20.6l-2.2-1.3c-52.1-31.1-83.2-85.3-83.2-144.9 0-93.5 76-169.5 169.5-169.5s169.5 76 169.5 169.5c0 59.6-31.1 113.8-83.2 144.9l-2.2 1.3c-8.1 4.9-15.2 11.8-20.2 20.6s-7.4 18.4-7.4 27.9V535c0 10.7 3 21.6 9.4 31.2 6.4 9.6 15.2 16.6 25.1 20.8l2.2 0.9c98.1 41.4 168.3 143.3 185.3 263h-557c17-119.6 87.2-221.5 185.3-262.9z",fill:"#3162e0","p-id":"4303"}),r.jsx("path",{d:"M788.8 593.2c64.2-41.5 103-118.7 87.2-203.8-13.6-73.2-70.5-134.2-142.5-153.1-47.1-12.4-91.9-7.1-130.6 9.8 8.1 17.1 14.5 35.1 18.1 54.2 18.5-8.9 38.9-14.3 60.8-14.3 89.6 0 159.9 83.8 136.8 177.1-8.9 35.9-34.1 65.6-65.2 85.6l10.7-6.9c-7.7 5-14.3 11.8-19 20.4-4.7 8.6-6.9 17.9-6.9 27v6.7c0 10.3 2.8 20.8 8.7 30.1 5.9 9.4 14.1 16.4 23.4 20.8l-6-2.9c74.4 35.6 126.3 113.5 139.8 206.9H681.8c2.3 18.5 3.8 37.3 3.8 56.5h217.5c34 0 61.4-30 56.3-63.6C941.9 730 878 635.8 788.8 593.2z",fill:"#3162e0","p-id":"4304"})]})}),r.jsx("div",{className:"flex-1 min-w-0",children:(A==null?void 0:A.showName)||"工作群"}),r.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-black text-white text-xs mr-2",children:(A==null?void 0:A.unreadCount)||0})]})}),r.jsx("div",{className:"flex-1 ",children:w?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),r.jsx("p",{className:"text-gray-600",children:"加载联系人中..."})]})}):O?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsxs("div",{className:"text-center text-red-500 p-4",children:[r.jsx("p",{children:O}),r.jsx("button",{className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg",onClick:()=>window.location.reload(),children:"重试"})]})}):r.jsx(gt,{contacts:n,onContactSelect:m,onMakeCall:Y,onScrollDirectionChange:p=>{t(p)}})})]})}function an(){const t=u.useRef(null),i=u.useRef(0),[d,e]=u.useState(!0),n=()=>{if(!t.current)return;const l=t.current.scrollTop,m=l>i.current?"down":"up";Math.abs(l-i.current)>50&&(e(m==="up"),i.current=l)},a=u.useCallback(l=>{e(l)},[]);return r.jsxs("div",{className:"flex flex-col h-screen bg-[#f5f6f8] overflow-hidden",children:[r.jsx("div",{className:"flex-1 min-w-[80px] sm:px-6 sm:py-2 text-gray-500 rounded-lg text-sm overflow-hidden",onScroll:n,children:r.jsx(Et,{setShowBottomNavGlobal:a})}),d&&r.jsx(ct,{})]})}export{an as default};
